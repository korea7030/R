{
    "contents" : "library(XLConnect)\nlibrary(ROCR)\ntot_score1 <- loadWorkbook('2015_1.xls')\ntot_score2 <- loadWorkbook('2015_2.xls')\n\n## get Cut off value\ngetCutOff <- function(mainData, fitData) {\n  pred <- data.frame(Direction = mainData$Direction, fit = fitData$fitted.values)\n  # get cut off \n  ob <- prediction(pred$fit, pred$Direction)\n  performance <- performance(ob, \"tpr\", \"fpr\")\n  # plot(performance)\n  err_perf <- performance(ob, \"err\")\n  plot(err_perf)\n  cut <- err_perf@x.values[[1]]\n  err <- err_perf@y.values[[1]]\n  cutoff <- cut[err == min(err)] ## cutoff value : 0.44\n  # plot(err.2014.korean~cut.2014.korean) ## cutoff graph\t\n  return (cutoff)\n}\n\ntot_score1.df <- readWorksheet(tot_score1, 1)\ntot_score2.df <- readWorksheet(tot_score2, 1)\n\nmerge_score <- merge(tot_score1.df, tot_score2.df)\nhead(merge_score)\nstr(merge_score)\nmerge_score$FIRST <- as.numeric(merge_score$FIRST)\nmerge_score$SECOND <- as.numeric(merge_score$SECOND)\n\nmerge_score$Direction <- 1\nmerge_score$Direction[merge_score$SECOND - merge_score$FIRST > 0] <- \"UP\"\nmerge_score$Direction[merge_score$SECOND - merge_score$FIRST <= 0] <- \"DOWN\"\n\nexcept_dept <- c(\"건축공학과\",\"실내건축학과\",\"토목공학과\",\"디지털콘텐츠학과\",\"컴퓨터소프트웨어공학과\",\"전자공학과\",\"정보통신공학과\",\"컴퓨터제어공학과\",\"e-비즈니스학과\",\"섬유의류비즈니스학과\",\"산업디자인학과\",\"패션디자인학과\",\"생활스포츠학과\",\"식품영양학과\",\"경영학과\",\"관광경영학과\",\"부동산금융정보학과\",\"비서학과\",\"세무회계학과\",\"행정학과\",\"유아교육과\",\"사회복지학과\")\nengineer <- c(\"건축과\",\"실내건축디자인과\",\"토목과\",\"컴퓨터정보보안과\",\"컴퓨터소프트웨어과\",\"전자과\",\"정보통신과\",\"지능로봇과\",\"e-비즈니스과\",\"섬유패션비즈니스과\",\"영상&게임콘텐츠과\", \"실내건축과\", \"디지털콘텐츠과\", \"모바일통신과\", \"컴퓨터제어과\", \"섬유의류비즈니스과\")\nsocial <- c(\"경영과\",\"호텔관광경영과\",\"부동산유통학과\",\"비서사무행정과\",\"세무회계과\",\"유아교육과\",\"사회복지과\",\"영유아보육과\",\"항공서비스과\", \"관광경영과\", \"부동산금융정보과\", \"비서과\", \"행정과\")\nart_psy <- c(\"광고디자인전공\",\"산업디자인과\",\"재활스포츠학과\", \"패션디자인과\", \"만화&2D영상그래픽전공\", \"3D영상그래픽전공\", \"쥬얼리디자인전공\", \"실용사진전공\", \"생활스포츠과\")\nscience <- c(\"식품영양과\",\"호텔외식조리학과\",\"간호학과\", \"호텔외식조리과\", \"간호과\")\n\n#### 전체 ################################################################################################\nmerge_score <- subset(merge_score, !(학과 %in% except_dept))\nmerge_score <- merge_score[-c(24748,25019,25085,27156),]\nmerge_score <- merge_score[-c(901,1220,1286,3564),]\nmerge_score$Direction <- as.factor(merge_score$Direction)\n\nfit.tot <- glm(Direction ~ SECOND, data = merge_score, family = binomial)\nsummary(fit.tot)\nexp(0.115479) # 1.122411\n\ntable(merge_score$Direction) ## DOWN : 3378 , UP : 2599\nerr.tot <- getCutOff(merge_score, fit.tot) # cutoff : 0.4946292\nxtabs(~merge_score$Direction+(fit.tot$fitted.values> err.tot))\n\n# merge_score$Direction FALSE TRUE\n#                  DOWN  2524  852\n#                  UP    1003 1596\n## Sensitivity = 1596 / (1003+1596) : 0.614\n## Specificity = 2524 / (2524+852) : 0.748\n## Error Rate = (852+1003) / (3378+2599) : 0.310\n#### 계열분리 #############################################################################################\nmerge_score.engineer <- subset(merge_score, 학과 %in% engineer)\nfit.engineer <- glm(Direction~SECOND, data = merge_score.engineer, family = binomial)\nsummary(fit.engineer)\nexp(0.10933) # 1.11553\n\ntable(merge_score.engineer$Direction) ## DOWN : 1360 , UP : 989\nerr.engineer <- getCutOff(merge_score.engineer, fit.engineer) # cutoff : 0.490392\nxtabs(~merge_score.engineer$Direction+(fit.engineer$fitted.values> err.engineer))\n# merge_score$Direction FALSE TRUE\n#                  DOWN  1041  319\n#                  UP     416  573\n## Sensitivity = 573 / (416+573) : 0.579\n## Specificity = 1041 / (1041+319) : 0.765\n## Error Rate = (319+416) / (1360+989) : 0.313\n\nmerge_score.social <- subset(merge_score, 학과 %in% social)\nfit.social <- glm(Direction~SECOND, data = merge_score.social, family = binomial)\nsummary(fit.social)\nexp(0.118190) # 1.125458\n\ntable(merge_score.social$Direction) ## DOWN : 1100 , UP : 822\nerr.social <- getCutOff(merge_score.social, fit.social) # cutoff : 0.5133138\nxtabs(~merge_score.social$Direction+(fit.social$fitted.values> err.social))\n# merge_score$Direction FALSE TRUE\n#                  DOWN   871  229\n#                  UP     350  472\n## Sensitivity = 472 / (350+472) : 0.574\n## Specificity = 871 / (871+229) : 0.792\n## Error Rate = (229+350) / (1100+822) : 0.301\n\nmerge_score.art_psy <- subset(merge_score, 학과 %in% art_psy)\nfit.art_psy <- glm(Direction~SECOND, data = merge_score.art_psy, family = binomial)\nsummary(fit.art_psy) \nexp(0.09710) # 1.101971\n\ntable(merge_score.art_psy$Direction) ## DOWN : 300 , UP : 222\nerr.art_psy <- getCutOff(merge_score.art_psy, fit.art_psy) # cutoff : 0.4797738\nxtabs(~merge_score.art_psy$Direction+(fit.art_psy$fitted.values> err.art_psy))\n# merge_score$Direction FALSE TRUE\n#                  DOWN   213   87\n#                  UP      88  134\n## Sensitivity = 134 / (134+88) : 0.604\n## Specificity = 213 / (213+87) : 0.71\n## Error Rate = (87+88) / (300+222) : 0.335\n\nmerge_score.science <- subset(merge_score, 학과 %in% science)\nfit.science <- glm(Direction~SECOND, data = merge_score.science, family = binomial)\nsummary(fit.science)\nexp(0.1441) # 1.155 \n\ntable(merge_score.science$Direction) ## DOWN : 1360 , UP : 989\nerr.science <- getCutOff(merge_score.science, fit.science) # cutoff : 0.490392\nxtabs(~merge_score.science$Direction+(fit.science$fitted.values> err.science))\n# merge_score$Direction FALSE TRUE\n#                  DOWN  1041  319\n#                  UP     416  573\n## Sensitivity = 573 / (416+573) : 0.579\n## Specificity = 1041 / (1041+319) : 0.765\n## Error Rate = (319+416) / (1360+989) : 0.313\n\n\n###########################################################################################################\n\n######################################################################################################################################\nquan_30 <- quantile(merge_score$SECOND, c(0,0.3,0.5,0.7,1.0), na.rm= TRUE)\nquan_30.engineer <- quantile(merge_score.engineer$SECOND, c(0,0.3,0.5,0.7,1.0), na.rm= TRUE)\nquan_30.social <- quantile(merge_score.social$SECOND, c(0,0.3,0.5,0.7,1.0), na.rm = TRUE)\nquan_30.art_psy <- quantile(merge_score.art_psy$SECOND, c(0,0.3,0.5,0.7,1.0), na.rm = TRUE)\nquan_30.science <- quantile(merge_score.science$SECOND , c(0,0.3,0.5,0.7,1.0), na.rm = TRUE)\n\nquan_40 <- quantile(merge_score$SECOND, c(0,0.2,0.4,0.6,0.8,1.0))\nquan_40.engineer <- quantile(merge_score.engineer$SECOND, c(0,0.2,0.4,0.6,0.8,1.0), na.rm= TRUE)\nquan_40.social <- quantile(merge_score.social$SECOND, c(0,0.2,0.4,0.6,0.8,1.0), na.rm = TRUE)\nquan_40.art_psy <- quantile(merge_score.art_psy$SECOND, c(0,0.2,0.4,0.6,0.8,1.0), na.rm = TRUE)\nquan_40.science <- quantile(merge_score.science$SECOND , c(0,0.2,0.4,0.6,0.8,1.0), na.rm = TRUE)\n\n#### 상위 30%(전체) #############################################################################################\nmerge_score_UP30 <- merge_score[merge_score$SECOND >= quan_30[4],]\nfit.tot.UP30 <- glm(Direction~SECOND, data = merge_score_UP30, family = binomial)\nsummary(fit.tot.UP30)\nexp(0.16790)  # 1.182818\n\ntable(merge_score_UP30$Direction) ## DOWN : 1360 , UP : 989\nerr.UP30 <- getCutOff(merge_score_UP30, fit.tot.UP30) # cutoff : 0.5486676 0.5482518\nxtabs(~merge_score_UP30$Direction+(fit.tot.UP30$fitted.values> err.UP30))\n# merge_score$Direction FALSE TRUE\n#                  DOWN    39  527\n#                  UP      37 1191\n## Sensitivity = 1191 / (37+1191) : 0.970\n## Specificity = 39 / (39+527) : 0.069\n## Error Rate = (527+37) / (1360+989) : 0.240\n\n#################################################################################################################\n#### 상위 30%(계열) #############################################################################################\nmerge_score.engineer_UP30 <- merge_score.engineer[merge_score.engineer$SECOND >= quan_30.engineer[4],]\nfit.engineer.UP30 <- glm(Direction~SECOND, data = merge_score.engineer_UP30, family = binomial)\nsummary(fit.engineer.UP30)\nexp(0.15093) # 1.162915\n\ntable(merge_score.engineer_UP30$Direction) ## DOWN : 248 , UP : 458\nerr.engineer.UP30 <- getCutOff(merge_score.engineer_UP30, fit.engineer.UP30) # cutoff : 0.544227\nxtabs(~merge_score.engineer_UP30$Direction+(fit.engineer.UP30$fitted.values> err.engineer.UP30))\n# merge_score$Direction FALSE TRUE\n#                  DOWN    53  195\n#                  UP      49  409\n## Sensitivity = 409 / (49+409) : 0.893\n## Specificity = 53 / (53+195) : 0.214\n## Error Rate = (195+49) / (248+458) : 0.346\n\nmerge_score.social_UP30 <- merge_score.social[merge_score.social$SECOND >= quan_30.social[4],]\nfit.social.UP30 <- glm(Direction~SECOND, data = merge_score.social_UP30, family = binomial)\nsummary(fit.social.UP30)\nexp(0.18797) # 0.18797\n\ntable(merge_score.social_UP30$Direction) ## DOWN : 178 , UP : 401\nerr.social.UP30 <- getCutOff(merge_score.social_UP30, fit.social.UP30) # cutoff : 0.5498255 0.5451686\nxtabs(~merge_score.social_UP30$Direction+(fit.social.UP30$fitted.values> err.social.UP30))\n# merge_score$Direction FALSE TRUE\n#                  DOWN    23  155\n#                  UP      19  382\n## Sensitivity = 382 / (382+19) : 0.953\n## Specificity = 23 / (23+155) : 0.129\n## Error Rate = (155+19) / (178+401) : 0.3\n\nmerge_score.art_psy_UP30 <- merge_score.art_psy[merge_score.art_psy$SECOND >= quan_30.art_psy[4],]\nfit.art_psy.UP <- glm(Direction~SECOND, data = merge_score.art_psy_UP30, family = binomial)\nsummary(fit.art_psy.UP)\nexp(0.18047) # 1.19778 \n\ntable(merge_score.art_psy_UP30$Direction) ## DOWN : 57 , UP : 100\nerr.art_psy.UP30 <- getCutOff(merge_score.art_psy_UP30, fit.art_psy.UP) # cutoff : 0.5015117\nxtabs(~merge_score.art_psy_UP30$Direction+(fit.art_psy.UP$fitted.values> err.art_psy.UP30))\n# merge_score$Direction FALSE TRUE\n#                  DOWN    5    52\n#                  UP      2    98\n## Sensitivity = 98 / (2+98) : 0.98\n## Specificity = 5 / (5+52) : 0.088\n## Error Rate = (52+2) / (57+100) : 0.344\n\nmerge_score.science_UP30 <- merge_score.science[merge_score.science$SECOND >= quan_30.science[4],]\nfit.science.UP <- glm(Direction~SECOND, data = merge_score.science_UP30, family = binomial)\nsummary(fit.science.UP) \nexp(0.23081) # 1.25962 \n\ntable(merge_score.science_UP30$Direction) ## DOWN : 39 , UP : 129\nerr.science.UP30 <- getCutOff(merge_score.science_UP30, fit.science.UP) # cutoff : 0.6295063\nxtabs(~merge_score.science_UP30$Direction+(fit.science.UP$fitted.values> err.science.UP30))\n# merge_score$Direction FALSE TRUE\n#                  DOWN     4   35\n#                  UP       3  126\n## Sensitivity = 126 / (126+3) : 0.977\n## Specificity =  4 / (4+35) : 0.103\n## Error Rate = (35+3) / (39+129) : 0.226\n\n#################################################################################################################\n#### 하위 30%(전체) #############################################################################################\nmerge_score_DOWN30 <- merge_score[merge_score$SECOND <= quan_30[2],]\nfit.tot.DOWN30 <- glm(Direction~SECOND, data = merge_score_DOWN30, family = binomial)\nsummary(fit.tot.DOWN30)\nexp(0.039842)  #1.040646\n\ntable(merge_score_DOWN30$Direction) ## DOWN : 1420 , UP : 375\nerr.DOWN30 <- getCutOff(merge_score_DOWN30, fit.tot.DOWN30) # Inf\nxtabs(~merge_score_DOWN30$Direction+(fit.tot.DOWN30$fitted.values> err.DOWN30))\n# merge_score$Direction FALSE\n#                  DOWN  1420\n#                  UP     375\n## Sensitivity = ?\n## Specificity = ?\n## Error Rate = ?\n#################################################################################################################\n#### 하위 30%(계열) #############################################################################################\nmerge_score.engineer_DOWN30 <- merge_score.engineer[merge_score.engineer$SECOND <= quan_30.engineer[2],]\nfit.engineer.DOWN30 <- glm(Direction~SECOND, data = merge_score.engineer_DOWN30, family = binomial)\nsummary(fit.engineer.DOWN30)\nexp(0.03371) # 1.034285\n\ntable(merge_score.engineer_DOWN30$Direction) ## DOWN : 568 , UP : 137\nerr.engineer.DOWN30 <- getCutOff(merge_score.engineer_DOWN30, fit.engineer.DOWN30) # cutoff : Inf\nxtabs(~merge_score.engineer_DOWN30$Direction+(fit.engineer.DOWN30$fitted.values> err.engineer.DOWN30))\n# merge_score$Direction FALSE\n#                  DOWN   568\n#                  UP     137\n## Sensitivity = ?\n## Specificity = ?\n## Error Rate = ?\n\nmerge_score.social_DOWN30 <- merge_score.social[merge_score.social$SECOND <= quan_30.social[2],]\nfit.social.DOWN30 <- glm(Direction~SECOND, data = merge_score.social_DOWN30, family = binomial)\nsummary(fit.social.DOWN30)\nexp(0.05353) # 1.054989\n\ntable(merge_score.social_DOWN30$Direction) ## DOWN : 459 , UP : 120\nerr.social.DOWN30 <- getCutOff(merge_score.social_DOWN30, fit.social.DOWN30) # cutoff : 0.2738212\nxtabs(~merge_score.social_DOWN30$Direction+(fit.social.DOWN30$fitted.values> err.social.DOWN30))\n# merge_score$Direction FALSE\n#                  DOWN   459\n#                  UP     120\n## Sensitivity = ?\n## Specificity = ?\n## Error Rate = ?\n\nmerge_score.art_psy_DOWN30 <- merge_score.art_psy[merge_score.art_psy$SECOND <= quan_30.art_psy[2],]\nfit.art_psy.DOWN30 <- glm(Direction~SECOND, data = merge_score.art_psy_DOWN30, family = binomial)\nsummary(fit.art_psy.DOWN30)\nexp(0.11445) # 1.121257\n\ntable(merge_score.art_psy_DOWN30$Direction) ## DOWN : 114 , UP : 43\nerr.art_psy.DOWN30 <- getCutOff(merge_score.art_psy_DOWN30, fit.art_psy.DOWN30) # cutoff : 0.4163132\nxtabs(~merge_score.art_psy_DOWN30$Direction+(fit.art_psy.DOWN30$fitted.values> err.art_psy.DOWN30))\n# merge_score$Direction FALSE TRUE\n#                  DOWN   111    3\n#                  UP      38    5\n## Sensitivity = 5 / (38+5) : 0.1162791\n## Specificity = 111 / (111+3) : 0.9736842\n## Error Rate = (3+38) / (114+43) : 0.2611465\n\n\nmerge_score.science_DOWN30 <- merge_score.science[merge_score.science$SECOND <= quan_30.science[2],]\nfit.science.DOWN30 <- glm(Direction~SECOND, data = merge_score.science_DOWN30, family = binomial)\nsummary(fit.science.DOWN30) \nexp(0.001457) # 1.001458\n\ntable(merge_score.art_psy_DOWN30$Direction) ## DOWN : 114 , UP : 43\nerr.art_psy.DOWN30 <- getCutOff(merge_score.art_psy_DOWN30, fit.art_psy.UP) # cutoff : 0.8671194 0.8511922\nxtabs(~merge_score.art_psy_DOWN30$Direction+(fit.art_psy.UP$fitted.values> err.art_psy.DOWN30))\n# merge_score$Direction FALSE TRUE\n#                  DOWN   114    0\n#                  UP      41    2\n## Sensitivity = 2 / (41+2) : 0.047\n## Specificity = 114 / (114) : 1\n## Error Rate = (0+41) / (114+43) : 0.261\n#################################################################################################################\n#### 하위 40%(전체) #############################################################################################\nmerge_score_DOWN40 <- merge_score[merge_score$SECOND <= quan_40[2],]\nfit.tot.DOWN40 <- glm(Direction~SECOND, data = merge_score_DOWN40, family = binomial)\nsummary(fit.tot.DOWN40)\nexp(0.04600)  #  1.047074\n\ntable(merge_score_DOWN40$Direction) ## DOWN : 959 , UP : 236\nerr.DOWN40 <- getCutOff(merge_score_DOWN40, fit.tot.DOWN40) # cutoff : 0.2547010 0.2545264\nxtabs(~merge_score_DOWN40$Direction+(fit.tot.DOWN40$fitted.values> err.DOWN40))\n# merge_score$Direction FALSE TRUE\n#                  DOWN   959    0\n#                  UP     235    1\n## Sensitivity = 1 / (235+1) : 0.004\n## Specificity = 959 / (959) : 1\n## Error Rate = (0+235) / (235+1) : 0.996\n\n#################################################################################################################\n#### 하위 40%(계열) #############################################################################################\nmerge_score.engineer_DOWN40 <- merge_score.engineer[merge_score.engineer$SECOND <= quan_40.engineer[2],]\nfit.engineer.DOWN40 <- glm(Direction~SECOND, data = merge_score.engineer_DOWN40, family = binomial)\nsummary(fit.engineer.DOWN40)\nexp(0.0305) # 1.031\n\ntable(merge_score.engineer_DOWN40$Direction) ## DOWN : 390 , UP : 82\nerr.engineer.DOWN40 <- getCutOff(merge_score.engineer_DOWN40, fit.engineer.DOWN40) # cutoff :  0.2119185 0.2118166\nxtabs(~merge_score.engineer_DOWN40$Direction+(fit.engineer.DOWN40$fitted.values> err.engineer.DOWN40))\n# merge_score$Direction FALSE TRUE\n#                  DOWN   389    1\n#                  UP      82    0\n## Sensitivity = 0\n## Specificity = 389 / (389+1) : 0.997\n## Error Rate = (1+82) / (390+82) : 0.176\n\nmerge_score.social_DOWN40 <- merge_score.social[merge_score.social$SECOND <= quan_40.social[2],]\nfit.social.DOWN40 <- glm(Direction~SECOND, data = merge_score.social_DOWN40, family = binomial)\nsummary(fit.social.DOWN40)\nexp(0.05880) # 1.060563\n\ntable(merge_score.social_DOWN40$Direction) ## DOWN : 314 , UP : 72\nerr.social.DOWN40 <- getCutOff(merge_score.social_DOWN40, fit.social.DOWN40) # cutoff : Inf\nxtabs(~merge_score.social_DOWN40$Direction+(fit.social.DOWN40$fitted.values> err.social.DOWN40))\n# merge_score$Direction FALSE\n#                  DOWN   314\n#                  UP      72\n## Sensitivity = ?\n## Specificity = ?\n## Error Rate = ?\n\nmerge_score.art_psy_DOWN40 <- merge_score.art_psy[merge_score.art_psy$SECOND <= quan_40.art_psy[2],]\nfit.art_psy.DOWN40 <- glm(Direction~SECOND, data = merge_score.art_psy_DOWN40, family = binomial)\nsummary(fit.art_psy.DOWN40)\nexp(0.15115) # 1.163171\n\ntable(merge_score.art_psy_DOWN40$Direction) ## DOWN : 81 , UP : 24\nerr.art_psy.DOWN40 <- getCutOff(merge_score.art_psy_DOWN40, fit.art_psy.DOWN40) # cutoff : 0.5015117\nxtabs(~merge_score.art_psy_DOWN40$Direction+(fit.art_psy.DOWN40$fitted.values> err.art_psy.DOWN40))\n# merge_score$Direction FALSE TRUE\n#                  DOWN   81     0\n#                  UP     23     1\n## Sensitivity = 1 / (23+1) :  0.041\n## Specificity = 81 / (81) : 1\n## Error Rate = (0+23) / (81+24) : 0.219\n\nmerge_score.science_DOWN40 <- merge_score.science[merge_score.science$SECOND <= quan_40.science[2],]\nfit.science.DOWN40 <- glm(Direction~SECOND, data = merge_score.science_DOWN40, family = binomial)\nsummary(fit.science.DOWN40) \nexp(0.01170) # 1.011769\n\ntable(merge_score.science_DOWN40$Direction) ## DOWN : 87 , UP : 25\nerr.science.DOWN40 <- getCutOff(merge_score.science_DOWN40, fit.science.DOWN40) # cutoff : Inf\nxtabs(~merge_score.science_DOWN40$Direction+(fit.science.DOWN40$fitted.values> err.science.DOWN40))\n# merge_score$Direction FALSE\n#                  DOWN    87 \n#                  UP      25  \n## Sensitivity = ?\n## Specificity = ?\n## Error Rate = ?\n#################################################################################################################\n#################################################################################################################\n#### 재교육 받은 학생 ###########################################################################################\nre_edu <- loadWorkbook('re.xlsx')\nre_edu.df <- readWorksheet(re_edu, 1)\nhead(re_edu.df)\n\nmerge_score.re <- subset(merge_score, 성명 %in% re_edu.df$성명)\nnrow(merge_score.re) # 794\n\nfit.re_edu <- glm(Direction~SECOND, data = merge_score.re , family = binomial)\nsummary(fit.re_edu)\nexp(0.11943)  # 1.126854\n\ntable(merge_score.re$Direction) ## DOWN : 445 , UP : 349\nerr.re <- getCutOff(merge_score.re, fit.re_edu) # cutoff : 0.5646323 0.4867719\nxtabs(~merge_score.re$Direction+(fit.re_edu$fitted.values> err.re))\n# merge_score$Direction FALSE TRUE\n#                  DOWN   353   92\n#                  UP     134  215\n## Sensitivity = 215 / (134+215) : 0.616\n## Specificity = 353 / (353+92) : 0.793\n## Error Rate = (92+134) / (445+349) : 0.285\n\n#################################################################################################################\n\n### re education subject odds \nre_eval_sub <- loadWorkbook('re_subject.xlsx')\nre_eval_sub_cnt3 <- readWorksheet(re_eval_sub, 1)\nre_eval_sub_cnt2 <- readWorksheet(re_eval_sub, 2)\n\nhead(re_eval_sub_cnt3)\nhead(re_eval_sub_cnt2)\n\ncol_cnt3 <- colnames(re_eval_sub_cnt3)\ncol_cnt2 <- colnames(re_eval_sub_cnt2)\n\nre_eval_sub_cnt3$Direction <- factor(re_eval_sub_cnt3$Direction)\nre_eval_sub_cnt2$Direction <- factor(re_eval_sub_cnt2$Direction)\n\ngetOdds <- function (mainData, subject_c) {\n   print (summary(glm(Direction~score3, data = subset(mainData, subject == subject_c) , family = binomial)))\n  return (glm(Direction~score3, data = subset(mainData, subject == subject_c) , family = binomial))\n}\n\n# subject name\nsubject_cnt3 <- unique(re_eval_sub_cnt3$subject)\nsubject_cnt2 <- unique(re_eval_sub_cnt2$subject)\n\n## full subject count3\nfit.cnt3 <- glm(Direction~score3, data = re_eval_sub_cnt3,  family = binomial)\nsummary(fit.cnt3)\nexp(0.037246) # 1.037948\n\n## Error Rate, Sensitivity, Specificity\ntable(re_eval_sub_cnt3$Direction) ## NO : 195 , YES : 217\nerr.cnt3 <- getCutOff(re_eval_sub_cnt3, fit.cnt3) # cutoff : 0.5249396\nxtabs(~re_eval_sub_cnt3$Direction+(fit.cnt3$fitted.values> err.cnt3))\n# re_eval_sub_cnt3$Direction FALSE TRUE\n#                       NO     147   48\n#                       YES    108  109\n## Sensitivity = 109 / (108+109) : 0.502\n## Specificity = 147 / (147+48) : 0.753\n## Error Rate = (48+108) / (195+217) : 0.379\n\n## full subject count2\nfit.cnt2 <- glm(Direction~score2, data = re_eval_sub_cnt2, family = binomial)\nsummary(fit.cnt2)\nexp(0.033171) # 1.033727\n\n## Error Rate, Sensitivity, Specificity\ntable(re_eval_sub_cnt2$Direction) ## NO : 89 , YES : 108\nerr.cnt2 <- getCutOff(re_eval_sub_cnt2, fit.cnt2) # cutoff : 0.5935224 0.5798496\nxtabs(~re_eval_sub_cnt2$Direction+(fit.cnt2$fitted.values> err.cnt2))\n# re_eval_sub_cnt3$Direction FALSE TRUE\n#                       NO      68   21\n#                       YES     43   65\n## Sensitivity = 65 / (43+65) : 0.602\n## Specificity = 68 / (68+21) : 0.764\n## Error Rate = (21+43) / (89+108) : 0.325\n",
    "created" : 1455186537341.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "689465431",
    "id" : "27B3F104",
    "lastKnownWriteTime" : 1455620691,
    "path" : "C:/RCodeRepositories/Bucheon_subject3/subject3.R",
    "project_path" : "subject3.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_source"
}