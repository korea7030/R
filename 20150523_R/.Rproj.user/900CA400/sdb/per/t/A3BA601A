{
    "contents" : "##Ploting-------------\nload(\"basketData.RData\")\nload(\"userRFM.RData\")\nhead(basketData)\nbasketData <- basketData[,-c(1)]\nhead(userRFM)\n\n# save(userRFM, file=\"userRFM.RData\")\ntblgrade <- table(userRFM$grade)\nplot(tblgrade)\nplot(tblgrade, type=\"l\")\ntitle(main=\"My first plot image\")\n\nplot(tblgrade, type=\"l\", xaxt=\"n\", ylab=\"\")\ntitle(main=\"My second plot image\")\naxis(1, at=1:length(tblgrade), \n     label=c(\"최우수고객\",\n             \"우수고객\",\n             \"보통고객\",\"평균 고객\",\n             \"불만고객\"))\ntitle(xlab=\"고객구분\", col.lab=\"red\")\ntitle(ylab=\"고객수\", col.lab=\"blue\")\n\nuserRFM$gradeFac <- factor(userRFM$grade, \n                           levels=c(\"A\",\"B\",\"C\",\"D\",\"E\"), ordered=T)\nboxplot(userRFM$score~userRFM$gradeFac)\nboxplot(userRFM$score~userRFM$grade, notch=T, col=c(\"red\", \"blue\", rep(\"black\",3)))\n\nlibrary(dplyr)\n# library(plyr)\nhead(basketData)\nhead(userRFM)\nuserRFM <- data.frame(userRFM)\n# basketData$datetime <- strptime(paste0(basketData$date,basketData$time), format=\"%Y%m%d%H\")\nbasketGrade <- left_join(basketData, \n                    userRFM[,c(\"custId\",\"grade\")])\ntail(basketGrade)\n# basketGrade <- basketGrade[,-(ncol(basketGrade)-1)]\n\ngraphOut <- basketGrade %>%\n  group_by(grade, custId, branchId) %>%\n  summarize(avgPurchase=mean(amount)) \n\ndim(graphOut)\n\nboxplot(graphOut$avgPurchase~graphOut$grade, notch=T)\n# 참조 : http://stackoverflow.com/questions/15181086/labeling-outliers-on-boxplot-in-r\nhead(basketGrade,1)\nlibrary(dplyr)\ngraphOut3 <- basketGrade %>%\n  group_by(category, division ) %>%\n  filter(category == \"livestock\") %>%\n  summarize(avgPurchase=mean(amount))\ndata.frame(graphOut3)\ngraphOut3$percentage <- \n  graphOut3$avgPurchase/sum(graphOut3$avgPurchase)\n\nhead(graphOut2, 10)\nboxplot(graphOut2$avgPurchase ~ \n          graphOut2$category)\nlibrary(reshape)\ngraphout3 <- cast(graphOut2, \n                  grade~category,\n                  value=\"avgPurchase\",\n                  fun.aggregate=sum)\nhead(graphout3)\nmatplot(graphout3, type=\"l\")\nhead(graphOut2)\nboxplot(graphOut2$N ~ graphOut2$grade)\nlibrary(reshape)\n\ngraphOut2 <- basketGrade %>%\n  group_by(grade, custId, branchId) %>%\n  summarize(Number=n())\ngraphOut2\ngraphDummy <- data.frame(graphOut2)\ngraphCast <- cast(graphDummy, grade ~ branchId, \n                  value=\"avgPurchase\", \n                  fun.aggregate=sum)\nhead(graphCast)\n\nmatplot(graphCast)\nmatplot(graphCast, type=\"o\")\nmatplot(graphCast, type=\"o\", pch=16)\nmatplot(graphCast, type=\"o\", pch=c(16,20,21,22), col=c(\"blue\", \"yellow\",\"magenta\",\"red\"))\nlegend(\"topright\",\n       c(\"branchId_1\",\"branchId_2\",\"branchId_3\",\"branchId_4\"), # puts text in the legend \n       lty=c(1,1,1,1), # gives the legend appropriate symbols (lines)\n       cex=1,\n       lwd=c(5, 5, 5,5),\n       col=c(\"blue\", \"yellow\",\"magenta\",\"red\"))\nmatplot(graphCast, type=\"o\", pch=c(16,20,21,22), col=c(\"blue\", \"yellow\",\"magenta\",\"red\"),\n        ylim=c(30,300))\nlegend(\"topright\",\n       c(\"branchId_1\",\"branchId_2\",\"branchId_3\",\"branchId_4\"),\n       lty=c(1,1,1,1), # gives the legend appropriate symbols (lines)\n       cex=1,\n       lwd=c(5, 5, 5,5),\n       col=c(\"blue\", \"yellow\",\"magenta\",\"red\"))\n\ngraphmat <- as.matrix(graphCast)\nhead(graphmat)\n\npdfpngplot(graphmat,\"pdfpngplot_01\",\"My first pdf_png Plot\",\"total Number of customers\")\n\npdfpngplot <- function(data, filename, maintitle, labtitle) {\n  # pdf 그래프 출력 샘플 -------\n  # 15 vs 11.25, 30 vs 22.5\n  \n  pdf(paste0(filename,\".pdf\"), width=10, height=7)\n  \n  par(mar=c(5,7,10,1))\n  \n  matplot(data, type=\"l\", xaxt=\"n\", yaxt=\"n\",\n          col=c(\"blue\", \"yellow\",\"magenta\",\"red\"),\n          lwd=c(3,3,3,3),ylab=\"\")\n  title(main=maintitle, \n        col.main=\"gray8\", cex.main=3.2)\n  title(ylab=labtitle, \n        col.lab=\"black\", cex.lab=3)\n  \n  axis(1,at=1:dim(data)[1],labels=row.names(data), las=2, cex=0.5)\n  axis(2, cex.axis=1.5)\n  \n  legend(\"topright\",\n         c(\"branchId_1\",\"branchId_2\",\"branchId_3\",\"branchId_4\"),\n         lty=c(1,1,1,1), # gives the legend appropriate symbols (lines)\n         cex=1,\n         lwd=c(5, 5, 5,5),\n         col=c(\"blue\", \"yellow\",\"magenta\",\"red\"))\n  dev.off()\n  \n  # png 그래프 출력 샘플 -------\n  png(paste0(filename,\".png\"), width=10, height=7, units = \"in\", res=400)\n  \n  par(mar=c(5,7,10,1))\n  \n  matplot(data, type=\"l\", xaxt=\"n\", yaxt=\"n\",\n          col=c(\"blue\", \"yellow\",\"magenta\",\"red\"),\n          lwd=c(3,3,3,3), ylab=\"\")\n  \n  title(main=maintitle, \n        col.main=\"gray8\", cex.main=3.2)\n  \n  title(ylab=labtitle, \n        col.lab=\"black\", cex.lab=3)\n  \n  axis(1,at=1:dim(data)[1],labels=row.names(data), las=2, cex=0.5)\n  axis(2, cex.axis=1.5)\n  \n  legend(\"topright\",\n         c(\"branchId_1\",\"branchId_2\",\"branchId_3\",\"branchId_4\"),\n         lty=c(1,1,1,1), # gives the legend appropriate symbols (lines)\n         cex=1,\n         lwd=c(5, 5, 5,5),\n         col=c(\"blue\", \"yellow\",\"magenta\",\"red\"))\n  dev.off()\n}\n\n\n#http://cran.r-project.org/doc/contrib/Lemon-kickstart/kr_addat.html\nplot(6:25,rnorm(20),type=\"b\",xlim=c(1,30),ylim=c(-2.5,2.5),col=2)\npar(new=T)\nplot(rnorm(30),type=\"b\",axes=F,col=3)\npar(new=F)\n\n#blank plot으로 시작하는 방법\nplot(1, type=\"n\", axes=F, xlab=\"\", ylab=\"\")\nplot(3, type=\"n\", axes=T, xlab=\"\", ylab=\"\")\nmatplot(graphCast, type=\"n\")\n\n# producing simple graph in R 참조 : http://www.harding.edu/fmccown/r/\n\n\n## ggplot2------------\ninstall.packages(\"ggplot2\")\nlibrary(ggplot2)\n\n# interesting graph by Liang Xianglong in SNU.\n\nf <- function(x) 1/(x^2-1)\nx <- seq(-3,3, by=0.001)\ny <- f(x)\nd <- data.frame(x=x, y=y)\n\np <- ggplot()\np <- p + geom_rect(fill=\"white\", color=\"black\", size=3,\n                   aes(NULL, NULL, xmin=-3, xmax=3,\n                       ymin=-3, ymax=3, alpha=0.1))\n\np <- p + geom_line(data=d, aes(x,y), size=3) + ylim(-3,3)\np\n\ntheme_null <- function() {\n  theme_bw() %+replace%\n    theme(axis.text.x=element_blank(),\n          axis.text.y=element_blank(),\n          legend.position=\"none\",\n          panel.grid.minor=element_blank(),\n          panel.grid.major=element_blank(),\n          panel.background=element_blank(),\n          axis.ticks=element_blank(),\n          panel.border=element_blank())\n}\n\np+theme_null()+xlab(\"\")+ylab(\"\")\n\n\np <- ggplot( mtcars, aes(mpg, wt, colour = cyl) ) + geom_point()\nmtcars <- transform(mtcars, mpg = mpg ^ 2)\np %+% mtcars \n\np %+% mtcars + geom_smooth()\np %+% mtcars + geom_smooth(method=loess)\n\np + geom_point( aes(colour = cyl) ) # 속성을 추가하거나,\np + geom_point( aes(y = disp) ) # 변경하는 것이 매우 자유로움.\n",
    "created" : 1432444609859.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "533434867",
    "id" : "A3BA601A",
    "lastKnownWriteTime" : 1432436068,
    "path" : "~/Rrepo/20150523_R/20150523_Week12_ploting_lec.R",
    "project_path" : "20150523_Week12_ploting_lec.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}