exp(0.05615) # 1.031217
fit.UP30.english.2015.art_psy <- glm(Direction~second_english, data = merge_2015_english_UP30.art_psy, family = binomial)
summary(fit.UP30.english.2015.art_psy)
exp(0.04296) # 1.031217
fit.UP30.english.2015.science <- glm(Direction~second_english, data = merge_2015_english_UP30.science, family = binomial)
summary(fit.UP30.english.2015.science)
exp(-0.008937) # 1.031217
fit.UP30.math.2015.engineer <- glm(Direction~second_math, data = merge_2015_math_UP30.engineer, family = binomial)
summary(fit.UP30.math.2015.engineer)
exp(0.09699) # 1.029363
quan_30_english.2015.engineer
merge_2014_korean_DOWN30.engineer<- merge_2014_korean.engineer[merge_2014_korean.engineer$second_korean <= quan_30_korean.2014.engineer[2],]
merge_2014_korean_DOWN30.social<- merge_2014_korean.social[merge_2014_korean.social$second_korean <= quan_30_korean.2014.social[2],]
merge_2014_korean_DOWN30.art_psy<- merge_2014_korean.art_psy[merge_2014_korean.art_psy$second_korean <= quan_30_korean.2014.art_psy[2],]
merge_2014_korean_DOWN30.science<- merge_2014_korean.science[merge_2014_korean.science$second_korean <= quan_30_korean.2014.science[2],]
merge_2015_korean_DOWN30.engineer<- merge_2015_korean.engineer[merge_2015_korean.engineer$second_korean <= quan_30_korean.2015.engineer[2],]
merge_2015_korean_DOWN30.social<- merge_2015_korean.social[merge_2015_korean.social$second_korean <= quan_30_korean.2015.social[2],]
merge_2015_korean_DOWN30.science<- merge_2015_korean.science[merge_2015_korean.science$second_korean <= quan_30_korean.2015.science[2],]
merge_2015_korean_DOWN30.art_psy<- merge_2015_korean.art_psy[merge_2015_korean.art_psy$second_korean <= quan_30_korean.2015.art_psy[2],]
merge_2014_english_DOWN30.engineer<- merge_2014_english.engineer[merge_2014_english.engineer$second_english <= quan_30_english.2014.engineer[2],]
merge_2014_english_DOWN30.social<- merge_2014_english.social[merge_2014_english.social$second_english <= quan_30_english.2014.social[2],]
merge_2014_english_DOWN30.art_psy<- merge_2014_english.art_psy[merge_2014_english.art_psy$second_english <= quan_30_english.2014.art_psy[2],]
merge_2014_english_DOWN30.science<- merge_2014_english.science[merge_2014_english.science$second_english <= quan_30_english.2014.science[2],]
merge_2015_english_DOWN30.engineer<- merge_2015_english.engineer[merge_2015_english.engineer$second_english <= quan_30_english.2015.engineer[2],]
merge_2015_english_DOWN30.social<- merge_2015_english.social[merge_2015_english.social$second_english <= quan_30_english.2015.social[2],]
merge_2015_english_DOWN30.art_psy<- merge_2015_english.art_psy[merge_2015_english.art_psy$second_english <= quan_30_english.2015.art_psy[2],]
merge_2015_english_DOWN30.science<- merge_2015_english.science[merge_2015_english.science$second_english <= quan_30_english.2015.science[2],]
merge_2014_math_DOWN30.engineer<- merge_2014_math.engineer[merge_2014_math.engineer$second_math <= quan_30_math.2014.engineer[2],]
merge_2015_math_DOWN30.engineer<- merge_2015_math.engineer[merge_2015_math.engineer$second_math <= quan_30_math.2015.engineer[2],]
fit.DOWN30.korean.2014.engineer <- glm(Direction~second_korean, data = merge_2014_korean_DOWN30.engineer, family = binomial)
summary(fit.DOWN30.korean.2014.engineer)
exp(0.05260) # 1.041852
merge_2014_korean_DOWN30.engineer
unique(merge_2014_korean_DOWN30.engineer$second_korean)
quan_30_korean.2014.engineer
fit.DOWN30.korean.2014.engineer <- glm(Direction~second_korean, data = merge_2014_korean_DOWN30.engineer, family = binomial)
summary(fit.DOWN30.korean.2014.engineer)
exp(0.05260) # 1.054008
fit.DOWN30.korean.2014.social <- glm(Direction~second_korean, data = merge_2014_korean_DOWN30.social, family = binomial)
summary(fit.DOWN30.korean.2014.social)
0.07147
exp(0.02804) # 1.074086
fit.DOWN30.korean.2014.social <- glm(Direction~second_korean, data = merge_2014_korean_DOWN30.social, family = binomial)
summary(fit.DOWN30.korean.2014.social)
exp(0.02804) # 1.028437
fit.DOWN30.korean.2014.art_psy <- glm(Direction~second_korean, data = merge_2014_korean_DOWN30.art_psy, family = binomial)
summary(fit.DOWN30.korean.2014.art_psy)
exp(-0.0002237) # 1.156768
fit.DOWN30.korean.2014.science <- glm(Direction~second_korean, data = merge_2014_korean_DOWN30.science, family = binomial)
summary(fit.DOWN30.korean.2014.science)
exp(-0.01451) # 0.9797871
summary(fit.DOWN30.english.2014.engineer)
summary(fit.DOWN30.korean.2014.science)
exp(-0.01451) # 0.9855948
fit.DOWN30.english.2014.engineer <- glm(Direction~second_english, data = merge_2014_english_DOWN30.engineer, family = binomial)
summary(fit.DOWN30.english.2014.engineer)
exp(0.12247) # 0.9855948
fit.DOWN30.english.2014.social <- glm(Direction~second_english, data = merge_2014_english_DOWN30.social, family = binomial)
summary(fit.DOWN30.english.2014.social)
fit.DOWN30.english.2014.engineer <- glm(Direction~second_english, data = merge_2014_english_DOWN30.engineer, family = binomial)
summary(fit.DOWN30.english.2014.engineer)
exp(0.12247) # 1.130285
fit.DOWN30.english.2014.social <- glm(Direction~second_english, data = merge_2014_english_DOWN30.social, family = binomial)
summary(fit.DOWN30.english.2014.social)
exp(0.05267) # 1.063133
fit.DOWN30.english.2014.art_psy <- glm(Direction~second_english, data = merge_2014_english_DOWN30.art_psy, family = binomial)
summary(fit.DOWN30.english.2014.art_psy)
exp(0.01537) # 1.050598
fit.DOWN30.english.2014.science <- glm(Direction~second_english, data = merge_2014_english_DOWN30.science, family = binomial)
summary(fit.DOWN30.english.2014.science)
exp(0.08217) # 0.9923236
fit.DOWN30.math.2014.engineer <- glm(Direction~second_math, data = merge_2014_math_DOWN30.engineer, family = binomial)
summary(fit.DOWN30.math.2014.engineer)
exp(0.09738) # 1.029363
fit.DOWN30.korean.2015.engineer <- glm(Direction~second_korean, data = merge_2015_korean_DOWN30.engineer, family = binomial)
summary(fit.DOWN30.korean.2015.engineer)
exp(0.04906) # 1.119632
fit.DOWN30.korean.2015.social <- glm(Direction~second_korean, data = merge_2015_korean_DOWN30.social, family = binomial)
summary(fit.DOWN30.korean.2015.social)
exp(0.05153) # 1.091344
fit.DOWN30.korean.2015.art_psy <- glm(Direction~second_korean, data = merge_2015_korean_DOWN30.art_psy, family = binomial)
summary(fit.DOWN30.korean.2015.art_psy)
exp(0.03817) # 1.034274
fit.DOWN30.korean.2015.science <- glm(Direction~second_korean, data = merge_2015_korean_DOWN30.science, family = binomial)
summary(fit.DOWN30.korean.2015.science)
exp(0.01757) # 1.120371
fit.DOWN30.english.2015.engineer <- glm(Direction~second_english, data = merge_2015_english_DOWN30.engineer, family = binomial)
summary(fit.DOWN30.english.2015.engineer)
exp(0.04254) # 1.043458
summary(fit.DOWN30.english.2015.engineer)
exp(0.07063) # 1.043458
fit.DOWN30.english.2015.social <- glm(Direction~second_english, data = merge_2015_english_DOWN30.social, family = binomial)
summary(fit.DOWN30.english.2015.social)
exp(0.09652) # 1.057756
fit.DOWN30.english.2015.art_psy <- glm(Direction~second_english, data = merge_2015_english_DOWN30.art_psy, family = binomial)
summary(fit.DOWN30.english.2015.art_psy)
exp(0.07437) # 1.043896
fit.DOWN30.english.2015.science <- glm(Direction~second_english, data = merge_2015_english_DOWN30.science, family = binomial)
summary(fit.DOWN30.english.2015.science)
exp(0.06404) # 0.9911028
fit.DOWN30.math.2015.engineer <- glm(Direction~second_math, data = merge_2015_math_DOWN30.engineer, family = binomial)
summary(fit.DOWN30.math.2015.engineer)
exp(0.04656) # 1.101849
merge_2014_korean_DOWN40.engineer<- merge_2014_korean.engineer[merge_2014_korean.engineer$second_korean <= quan_40_korean.2014.engineer[3],]
merge_2014_korean_DOWN40.social<- merge_2014_korean.social[merge_2014_korean.social$second_korean <= quan_40_korean.2014.social[3],]
merge_2014_korean_DOWN40.art_psy<- merge_2014_korean.art_psy[merge_2014_korean.art_psy$second_korean <= quan_40_korean.2014.art_psy[3],]
merge_2014_korean_DOWN40.science<- merge_2014_korean.science[merge_2014_korean.science$second_korean <= quan_40_korean.2014.science[3],]
merge_2015_korean_DOWN40.engineer<- merge_2015_korean.engineer[merge_2015_korean.engineer$second_korean <= quan_40_korean.2015.engineer[3],]
merge_2015_korean_DOWN40.social<- merge_2015_korean.social[merge_2015_korean.social$second_korean <= quan_40_korean.2015.social[3],]
merge_2015_korean_DOWN40.art_psy<- merge_2015_korean.art_psy[merge_2015_korean.art_psy$second_korean <= quan_40_korean.2015.art_psy[3],]
merge_2015_korean_DOWN40.science<- merge_2015_korean.science[merge_2015_korean.science$second_korean <= quan_40_korean.2015.science[3],]
merge_2014_english_DOWN40.engineer<- merge_2014_english.engineer[merge_2014_english.engineer$second_english <= quan_40_english.2014.engineer[3],]
merge_2014_english_DOWN40.social<- merge_2014_english.social[merge_2014_english.social$second_english <= quan_40_english.2014.social[3],]
merge_2014_english_DOWN40.art_psy<- merge_2014_english.art_psy[merge_2014_english.art_psy$second_english <= quan_40_english.2014.art_psy[3],]
merge_2014_english_DOWN40.science<- merge_2014_english.science[merge_2014_english.science$second_english <= quan_40_english.2014.science[3],]
merge_2015_english_DOWN40.engineer<- merge_2015_english.engineer[merge_2015_english.engineer$second_english <= quan_40_english.2015.engineer[3],]
merge_2015_english_DOWN40.social<- merge_2015_english.social[merge_2015_english.social$second_english <= quan_40_english.2015.social[3],]
merge_2015_english_DOWN40.art_psy<- merge_2015_english.art_psy[merge_2015_english.art_psy$second_english <= quan_40_english.2015.art_psy[3],]
merge_2015_english_DOWN40.science<- merge_2015_english.science[merge_2015_english.science$second_english <= quan_40_english.2015.science[3],]
merge_2014_math_DOWN40.engineer<- merge_2014_math.engineer[merge_2014_math.engineer$second_math <= quan_40_math.2014.engineer[3],]
merge_2015_math_DOWN40.engineer<- merge_2015_math.engineer[merge_2015_math.engineer$second_math <= quan_40_math.2015.engineer[3],]
quan_40_math.2015.engineer[3]
fit.DOWN40.korean.2014.engineer <- glm(Direction~second_korean, data = merge_2014_korean_DOWN40.engineer, family = binomial)
summary(fit.DOWN40.korean.2014.engineer)
exp(0.03658) # 1.041852
fit.DOWN40.korean.2014.social <- glm(Direction~second_korean, data = merge_2014_korean_DOWN40.social, family = binomial)
summary(fit.DOWN40.korean.2014.social)
exp(0.01559) # 1.074086
fit.DOWN40.korean.2014.art_psy <- glm(Direction~second_korean, data = merge_2014_korean_DOWN40.art_psy, family = binomial)
summary(fit.DOWN40.korean.2014.art_psy)
exp(-0.0002237) # 1.156768
fit.DOWN40.korean.2014.science <- glm(Direction~second_korean, data = merge_2014_korean_DOWN40.science, family = binomial)
summary(fit.DOWN40.korean.2014.science)
exp(0.04169) # 0.9797871
fit.DOWN40.english.2014.engineer <- glm(Direction~second_english, data = merge_2014_english_DOWN40.engineer, family = binomial)
summary(fit.DOWN40.english.2014.engineer)
exp(0.09276) # 0.9955101
fit.DOWN40.english.2014.social <- glm(Direction~second_english, data = merge_2014_english_DOWN40.social, family = binomial)
summary(fit.DOWN40.english.2014.social)
exp(0.06785) # 1.063133
fit.DOWN40.english.2014.art_psy <- glm(Direction~second_english, data = merge_2014_english_DOWN40.art_psy, family = binomial)
summary(fit.DOWN40.english.2014.art_psy)
exp(0.001263) # 1.050598
fit.DOWN40.english.2014.science <- glm(Direction~second_english, data = merge_2014_english_DOWN40.science, family = binomial)
summary(fit.DOWN40.english.2014.science)
exp(0.04295) # 0.9923236
fit.DOWN40.math.2014.engineer <- glm(Direction~second_math, data = merge_2014_math_DOWN40.engineer, family = binomial)
summary(fit.DOWN40.math.2014.engineer)
exp(0.07578) # 1.029363
fit.DOWN40.korean.2015.engineer <- glm(Direction~second_korean, data = merge_2015_korean_DOWN40.engineer, family = binomial)
summary(fit.DOWN40.korean.2015.engineer)
exp(0.039573) # 1.119632
fit.DOWN40.korean.2015.social <- glm(Direction~second_korean, data = merge_2015_korean_DOWN40.social, family = binomial)
summary(fit.DOWN40.korean.2015.social)
exp(0.04022) # 1.091344
fit.DOWN40.korean.2015.art_psy <- glm(Direction~second_korean, data = merge_2015_korean_DOWN40.art_psy, family = binomial)
summary(fit.DOWN40.korean.2015.art_psy)
exp(0.04436) # 1.034274
fit.DOWN40.korean.2015.science <- glm(Direction~second_korean, data = merge_2015_korean_DOWN40.science, family = binomial)
summary(fit.DOWN40.korean.2015.science)
exp(0.04549) # 1.120371
fit.DOWN40.english.2015.engineer <- glm(Direction~second_english, data = merge_2015_english_DOWN40.engineer, family = binomial)
summary(fit.DOWN40.english.2015.engineer)
exp(0.050159) # 1.043458
.
fit.DOWN40.english.2015.social <- glm(Direction~second_english, data = merge_2015_english_DOWN40.social, family = binomial)
summary(fit.DOWN40.english.2015.social)
exp(0.06907) # 1.057756
summary(fit.DOWN40.english.2015.engineer)
summary(fit.DOWN40.korean.2015.science)
summary(fit.DOWN40.english.2015.art_psy)
fit.DOWN40.english.2015.art_psy <- glm(Direction~second_english, data = merge_2015_english_DOWN40.art_psy, family = binomial)
summary(fit.DOWN40.english.2015.art_psy)
exp(0.05114) # 1.043896
fit.DOWN40.english.2015.science <- glm(Direction~second_english, data = merge_2015_english_DOWN40.science, family = binomial)
summary(fit.DOWN40.english.2015.science)
exp(0.04935) # 0.9911028
fit.DOWN40.math.2015.engineer <- glm(Direction~second_math, data = merge_2015_math_DOWN40.engineer, family = binomial)
summary(fit.DOWN40.math.2015.engineer)
exp(0.029620) # 1.101849
library(XLConnect)
library(ROCR)
re_edu <- loadWorkbook("2015_re.xlsx")
re_edu_korean <- readWorksheet(re_edu, 1)
re_edu_english <- readWorksheet(re_edu, 2)
re_edu_math <- readWorksheet(re_edu, 3)
head(re_edu_math)
subset(merge_2015_korean, 성명 %in% re_edu_korean$성명)
subset(merge_2015_korean, 성명 %in% re_edu_korean$성명)
edu_2015_re.korean <- subset(merge_2015_korean, 성명 %in% re_edu_korean$성명)
edu_2015_re.english <- subset(merge_2015_english, 성명 %in% re_edu_english$성명)
edu_2015_re.math <- subset(merge_2015_math, 성명 %in% re_edu_math$성명)
nrow(edu_2015_re.korean)
nrow(edu_2015_re.korean) ## 국어 55명
nrow(edu_2015_re.english)
nrow(edu_2015_re.math)
re_edu_math
edu_2015_re.korean
fit.re.korean <- glm(Direction, second_korean, data = edu_2015_re.korean, family = binomial)
head(edu_2015_re.korean)
fit.re.korean <- glm(Direction, second_korean, data = edu_2015_re.korean, family = binomial)
fit.re.korean <- glm(Direction~second_korean, data = edu_2015_re.korean, family = binomial)
fit.re.korean <- glm(Direction~second_korean, data = edu_2015_re.korean, family = binomial)
fit.re.english <- glm(Direction~second_english, data = edu_2015_re.english, family = binomial)
fit.re.math <- glm(Direction~second_math, data = edu_2015_re.math, family = binomial)
summary(fit.re.korean)
exp(0.05252) ##
fit.re.english <- glm(Direction~second_english, data = edu_2015_re.english, family = binomial)
summary(fit.re.english)
exp(0.05046) ##
fit.re.math <- glm(Direction~second_math, data = edu_2015_re.math, family = binomial)
summary(fit.re.math)
exp(1.218e-15)
table(merge_2014_korean$Direction)
table(merge_2014_english$Direction)
table(merge_2014_math$Direction)
fit.korean.2015 <- glm(Direction ~ second_korean, data = merge_2015_korean, family = binomial)
summary(fit.korean.2015)
exp(0.068193) # Odds : 1.032671
fit.english.2015 <- glm(Direction ~ second_english, data = merge_2015_english , family = binomial)
summary(fit.english.2015)
exp(0.035152) # Odds : 1.032258
fit.math.2015 <- glm(Direction~second_math, data = merge_2015_math, family = binomial)
summary(fit.math.2015)
exp(0.037110) # 1.035982
pred.2014.korean <- data.frame(Direction = merge_2014_korean$Direction, fit = fit.korean$fitted.values)
head(pred.2014.korean)
xtabs(~merge_2014_korean$Direction+(fit.korean$fitted.values> 0.5))
head(pred.2014.korean)
xtabs(~merge_2014_korean$Direction+(fit.korean$fitted.values> 0.5))
pred.2014.english <- data.frame(Direction = merge_2014_english$Direction, fit = fit.english$fitted.values)
xtabs(~merge_2014_english$Direction+(fit.english$fitted.values > 0.5))
library(ROCR)
pred.2014.korean_ob <- prediction(pred.2014.korean$fit, pred.2014.korean$Direction)
performance(pred.2014.korean_ob)
performance(pred.2014.korean_ob)
performance(pred.2014.korean_ob)
xtabs(~merge_2014_korean$Direction+(fit.korean$fitted.values> 0.5))
pred.2014.english_ob <- prediction(pred.2014.english$fit, pred.2014.english$Direction)
performance(pred.2014.english_ob)
performance(pred.2014.korean_ob, "auc")
perf.2014.korean <- performance(pred.2014.korean_ob, "auc")
plot(perf.2014.korean)
perf.2014.korean <- performance(pred.2014.korean_ob, "tpr", "fpr")
plot(perf.2014.korean)
performance(pred.2014.korean_ob)
performance(pred.2014.korean_ob, "auc")
err.2014.korean <- performance(pred.2014.korean_ob, "err")
err.2014.korean
min(err.2014.korean)
min(err.2014.korean@x.values)
err.2014.korean <- performance(pred.2014.korean_ob, "err")
min(err.2014.korean@x.values)
plot(err.2014.korean)
cut.2014.korean <- err.2014.korean@x.values[[1]]
err.2014.korean <- err.2014.korean@y.values[[1]]
cut.2014.korean[err.2014.korean == min(err.2014.korean))]
min(err.2014.korean)
cut.2014.korean[err.2014.korean == min(err.2014.korean)]
plot(err.2014.korean~cut.2014.korean)
xtabs(~merge_2014_korean$Direction+(fit.korean$fitted.values> 0.44))
getCutOff <- function(mainData, fitData) {
pred <- data.frame(Direction = mainData$Direction, fit = fitData$fitted.values)
# get cut off
ob <- prediction(pred$fit, pred$Direction)
performance <- performance(ob, "tpr", "fpr")
# plot(performance)
err_perf <- performance(ob, "err")
plot(err_perf)
cut <- err_perf@x.values[[1]]
err <- err_perf@y.values[[1]]
cutoff <- cut[err == min(err)] ## cutoff value : 0.44
# plot(err.2014.korean~cut.2014.korean) ## cutoff graph
return (cutoff)
}
err.2014.korean <- getCutOff(merge_2014_korean, fit.korean)
err.2014.korean
xtabs(~merge_2014_korean$Direction+(fit.korean$fitted.values> err.2014.korean))
err.2014.english <- getCutOff(merge_2014_english, fit.english)
err.2014.english
xtabs(~merge_2014_english$Direction+(fit.english$fitted.values > err.2014.english))
xtabs(~merge_2014_korean$Direction+(fit.korean$fitted.values> err.2014.korean))
429 / (204+429)
384 / (384+204)
(272+204) / (656+633)
err.2014.math <- getCutOff(merge_2014_math, fit.math)
xtabs(~merge_2014_math$Direction+(fit.math$fitted.values > err.2014.math))
27 / (98+27)
384 / (384+272)
252 / (252+17)
(17+98)/ (269+125)
a <- xtabs(~merge_2014_math$Direction+(fit.math$fitted.values > err.2014.math))
a
table(merge_2014_korean.engineer$Direction) ## DOWN : 656 , UP : 633
err.2014.korean.engineer <- getCutOff(merge_2014_korean.engineer, fit.korean.engineer.2014) # 0.4600607
err.2014.korean.engineer
xtabs(~merge_2014_korean.engineer$Direction+(fit.korean.engineer.2014$fitted.values > err.2014.korean.engineer))
1 / (164+1)
451 / (451+0)
(0+164)/ (451+165)
table(merge_2014_korean.social$Direction) ## DOWN : 451 , UP : 165
err.2014.korean.social <- getCutOff(merge_2014_korean.social, fit.korean.social.2014) # 0.4996522
err.2014.korean.social
xtabs(~merge_2014_korean.social$Direction+(fit.korean.social.2014$fitted.values > err.2014.korean.social))
err.2014.korean.social <- getCutOff(merge_2014_korean.social, fit.korean.social.2014) # 0.4996522
err.2014.korean.social
table(merge_2014_korean.art_psy$Direction) ## DOWN : 451 , UP : 165
err.2014.korean.art_psy <- getCutOff(merge_2014_korean.art_psy, fit.korean.art_psy.2014) # 0.4996522
err.2014.korean.art_psy
xtabs(~merge_2014_korean.art_psy$Direction+(fit.korean.art_psy.2014$fitted.values > err.2014.korean.art_psy))
table(merge_2014_korean.science$Direction) ## DOWN : 451 , UP : 165
err.2014.korean.science <- getCutOff(merge_2014_korean.science, fit.korean.science.2014) # 0.4996522
err.2014.korean.science
xtabs(~merge_2014_korean.science$Direction+(fit.korean.science.2014$fitted.values > err.2014.korean.science))
table(merge_2015_korean$Direction) ## DOWN : 1038 , UP : 251
err.2015.korean <- getCutOff(merge_2015_korean, fit.korean) # cutoff : 0.4365607
err.2015.korean <- getCutOff(merge_2015_korean, fit.korean.2015) # cutoff : 0.4365607
err.2015.korean
xtabs(~merge_2015_korean$Direction+(fit.korean.2015$fitted.values> err.2015.korean))
517 / (643+517)
1561 / (1561+217)
## Error Rate = (643+217) / (1778+1160) : 0.369
(643+217) / (1778+1160)
table(merge_2015_english$Direction) ## DOWN : 656 , UP : 633
err.2015.english <- getCutOff(merge_2015_english, fit.english.2015) # 0.4600607
err.2015.english
xtabs(~merge_2015_english$Direction+(fit.english.2015$fitted.values > err.2015.english))
529 / (667+529)
1372 / (1372+370)
## Sensitivity = 529 / (667+529) : 0.442
529 / (667+529)
## Error Rate = (370+667) / (1742+1196) : 0.369
(370+667) / (1742+1196)
table(merge_2015_math$Direction) ## DOWN : 269, UP : 125
err.2015.math <- getCutOff(merge_2015_math, fit.math.2015)
err.2015.math
xtabs(~merge_2015_math$Direction+(fit.math.2015$fitted.values > err.2015.math))
102 / (102+259)
151 / (151+90)
(90+102)/ (241+361)
## Sensitivity = 102 / (102+259) : 0.282
102 / (102+259)
table(merge_2015_math$Direction) ## DOWN : 241, UP : 361
table(merge_2014_korean_UP30$Direction) ## DOWN : 120 , UP : 19
err.2014.UP30.korean <- getCutOff(merge_2014_korean_UP30, fit.UP30.korean.2014) # Inf
err.2014.UP30.korean
err.2014.UP30.korean
xtabs(~merge_2014_korean_UP30$Direction+(fit.UP30.korean.2014$fitted.values > err.2014.UP30.korean))
table(merge_2014_english_UP30$Direction) ## DOWN : 412 , UP : 148
err.2014.UP30.english <- getCutOff(merge_2014_english_UP30, fit.UP30.english.2014) # 0.4216374
err.2014.UP30.english
err.2014.UP30.english <- getCutOff(merge_2014_english_UP30, fit.UP30.english.2014) # 0.5946994
xtabs(~merge_2014_english_UP30$Direction+(fit.UP30.english.2014$fitted.values > err.2014.UP30.english))
204 / (78+204)
37 / (37+120)
(120+78) / (157+282)
table(merge_2014_math_UP30$Direction) ## DOWN : 412 , UP : 148
err.2014.UP30.math <- getCutOff(merge_2014_math_UP30, fit.UP30.math.2014) # 0.4216374
err.2014.UP30.math
xtabs(~merge_2014_math_UP30$Direction+(fit.UP30.math.2014$fitted.values > err.2014.UP30.math))
17 / 56+17
27 / (46+27)
56 / (56+17)
(17+46) / (73+73)
table(merge_2015_korean_UP30$Direction) ## DOWN : 412 , UP : 148
err.2015.UP30.korean <- getCutOff(merge_2015_korean_UP30, fit.UP30.korean.2015) # 0.4216374
err.2015.UP30.korean
xtabs(~merge_2015_korean_UP30$Direction+(fit.UP30.korean.2015$fitted.values > err.2015.UP30.korean))
320 / 197+320
320 / (197+320)
119 / (119+98)
(98+197) / (217+517)
table(merge_2015_english_UP30$Direction) ## DOWN : 157 , UP : 282
err.2015.UP30.english <- getCutOff(merge_2015_english_UP30, fit.UP30.english.2015) # 0.5946994
err.2015.UP30.english
xtabs(~merge_2015_english_UP30$Direction+(fit.UP30.english.2015$fitted.values > err.2015.UP30.english))
529 / (529+126)
118 / (118+370)
(370+126) / (488+655)
118 / (118+370)
529 / (529+126)
table(merge_2015_math_UP30$Direction) ## DOWN : 73 , UP : 73
err.2015.UP30.math <- getCutOff(merge_2015_math_UP30, fit.UP30.math.2015) # 0.5221217
err.2015.UP30.math
err.2015.UP30.english
xtabs(~merge_2015_math_UP30$Direction+(fit.UP30.math.2015$fitted.values > err.2015.UP30.math))
236 / (23+236)
22 / (22+68)
(68+23) / (90+259)
table(merge_2014_korean_DOWN30$Direction) ## DOWN : 412 , DOWN : 148
err.2014.DOWN30.korean <- getCutOff(merge_2014_korean_DOWN30, fit.DOWN30.korean.2014) # 0.4216374
err.2014.DOWN30.korean
xtabs(~merge_2014_korean_DOWN30$Direction+(fit.DOWN30.korean.2014$fitted.values > err.2014.DOWN30.korean))
table(merge_2014_english_DOWN30$Direction) ## DOWN : 157 , DOWN : 282
err.2014.DOWN30.english <- getCutOff(merge_2014_english_DOWN30, fit.DOWN30.english.2014) # 0.5946994
err.2014.DOWN30.english
err.2014.DOWN30.english
err.2014.DOWN30.english
err.2014.DOWN30.english
err.2014.DOWN30.english
err.2014.DOWN30.english
err.2014.DOWN30.english
err.2014.DOWN30.english <- getCutOff(merge_2014_english_DOWN30, fit.DOWN30.english.2014) # Inf 0.5663065
err.2014.DOWN30.english
xtabs(~merge_2014_english_DOWN30$Direction+(fit.DOWN30.english.2014$fitted.values > err.2014.DOWN30.english))
table(merge_2014_math_DOWN30$Direction) ## DOWN : 73 , DOWN : 73
err.2014.DOWN30.math <- getCutOff(merge_2014_math_DOWN30, fit.DOWN30.math.2014) # 0.5221217
err.2014.DOWN30.math
xtabs(~merge_2014_math_DOWN30$Direction+(fit.DOWN30.math.2014$fitted.values > err.2014.DOWN30.math))
xtabs(~merge_2014_english_DOWN30$Direction+(fit.DOWN30.english.2014$fitted.values > err.2014.DOWN30.english))
xtabs(~merge_2014_korean_DOWN30$Direction+(fit.DOWN30.korean.2014$fitted.values > err.2014.DOWN30.korean))
table(merge_2015_korean_DOWN30$Direction) ## DOWN : 217 , DOWN : 517
err.2015.DOWN30.korean <- getCutOff(merge_2015_korean_DOWN30, fit.DOWN30.korean.2015) # 0.6204663
err.2015.DOWN30.korean
xtabs(~merge_2015_korean_DOWN30$Direction+(fit.DOWN30.korean.2015$fitted.values > err.2015.DOWN30.korean))
table(merge_2015_english_DOWN30$Direction) ## DOWN : 488 , DOWN : 655
err.2015.DOWN30.english <- getCutOff(merge_2015_english_DOWN30, fit.DOWN30.english.2015) # 0.4922861
err.2015.DOWN30.english
xtabs(~merge_2015_english_DOWN30$Direction+(fit.DOWN30.english.2015$fitted.values > err.2015.DOWN30.english))
table(merge_2015_math_DOWN30$Direction) ## DOWN : 90 , DOWN : 259
err.2015.DOWN30.math <- getCutOff(merge_2015_math_DOWN30, fit.DOWN30.math.2015) # 0.5181663
err.2015.DOWN30.math
xtabs(~merge_2015_math_DOWN30$Direction+(fit.DOWN30.math.2015$fitted.values > err.2015.DOWN30.math))
table(merge_2014_korean_DOWN40$Direction) ## DOWN : 390 , DOWN : 50
err.2014.DOWN40.korean <- getCutOff(merge_2014_korean_DOWN40, fit.DOWN40.korean.2014) # Inf
err.2014.DOWN40.korean
xtabs(~merge_2014_korean_DOWN40$Direction+(fit.DOWN40.korean.2014$fitted.values > err.2014.DOWN40.korean))
table(merge_2014_english_DOWN40$Direction) ## DOWN : 311 , DOWN : 125
err.2014.DOWN40.english <- getCutOff(merge_2014_english_DOWN40, fit.DOWN40.english.2014) # Inf 0.5663065
err.2014.DOWN40.english
xtabs(~merge_2014_english_DOWN40$Direction+(fit.DOWN40.english.2014$fitted.values > err.2014.DOWN40.english))
table(merge_2014_math_DOWN40$Direction) ## DOWN : 108 , DOWN : 19
err.2014.DOWN40.math <- getCutOff(merge_2014_math_DOWN40, fit.DOWN40.math.2014) # Inf
err.2014.DOWN40.math
xtabs(~merge_2014_math_DOWN40$Direction+(fit.DOWN40.math.2014$fitted.values > err.2014.DOWN40.math))
table(merge_2015_korean_DOWN40$Direction) ## DOWN : 1079 , DOWN : 285
err.2015.DOWN40.korean <- getCutOff(merge_2015_korean_DOWN40, fit.DOWN40.korean.2015) # Inf
err.2015.DOWN40.korean
xtabs(~merge_2015_korean_DOWN40$Direction+(fit.DOWN40.korean.2015$fitted.values > err.2015.DOWN40.korean))
fit.DOWN40.korean.2015$fitted.values
table(merge_2015_english_DOWN40$Direction) ## DOWN : 629 , DOWN : 134
err.2015.DOWN40.english <- getCutOff(merge_2015_english_DOWN40, fit.DOWN40.english.2015) # Inf
err.2015.DOWN40.english
xtabs(~merge_2015_english_DOWN40$Direction+(fit.DOWN40.english.2015$fitted.values > err.2015.DOWN40.english))
table(merge_2015_math_DOWN40$Direction) ## DOWN : 81 , DOWN : 30
err.2015.DOWN40.math <- getCutOff(merge_2015_math_DOWN40, fit.DOWN40.math.2015) # Inf
err.2015.DOWN40.math
xtabs(~merge_2015_math_DOWN40$Direction+(fit.DOWN40.math.2015$fitted.values > err.2015.DOWN40.math))
table(edu_2015_re.korean$Direction) ## DOWN : 1038 , UP : 251
re.err.2015.korean <- getCutOff(edu_2015_re.korean, fit.re.korean) # cutoff : 0.4365607
re.err.2015.korean
xtabs(~edu_2015_re.korean$Direction+(fit.re.korean$fitted.values> re.err.2015.korean))
10 / (10+8)
30 / (30+7)
(7+8) / (37+18)
table(edu_2015_re.english$Direction) ## DOWN : 656 , UP : 633
re.err.2015.english <- getCutOff(edu_2015_re.english, fit.re.english) # 0.4600607
re.err.2015.english
re.err.2015.korean <- getCutOff(edu_2015_re.korean, fit.re.korean) # cutoff : 0.3872484
re.err.2015.korean
xtabs(~edu_2015_re.english$Direction+(fit.re.english$fitted.values > re.err.2015.english))
re.err.2015.english
xtabs(~edu_2015_re.english$Direction+(fit.re.english$fitted.values > re.err.2015.english))
13 / (16+13)
39 / (39+7)
(7+16) / (46+29)
table(edu_2015_re.math$Direction) ## DOWN : 269, UP : 125
re.err.2015.math <- getCutOff(edu_2015_re.math, fit.re.math)
Q
fit.re.math <- glm(Direction~second_math, data = edu_2015_re.math, family = binomial)
summary(fit.re.math)
exp(1.218e-15) ## 1 (because very small data : 2)
library(ROCR)
library(XLConnect)
summary(fit.math.2015)
xtabs(~merge_2014_korean$Direction+(fit.korean$fitted.values> err.2014.korean))
summary(fit.korean.art_psy.2015)
err.2014.korean <- getCutOff(merge_2014_korean, fit.korean) # cutoff : 0.4365607
xtabs(~merge_2014_korean$Direction+(fit.korean$fitted.values> err.2014.korean))
re.err.2015.korean <- getCutOff(edu_2015_re.korean, fit.re.korean) # cutoff : 0.3872484
summary(fit.DOWN40.english.2015)
exp(0.055975) # 1.057571
summary(fit.DOWN40.math.2015)
exp(0.09408) # 1.098648
head(merge_2014_korean)
with(merge_2014_korean, t.test(second_korean - first_korean, alternative = "greater"))
with(merge_2014_korean, t.test(second_korean - first_korean), alternative = "greater")
with(merge_2014_korean, t.test(second_korean - first_korean), alternative = "greater")
with(merge_2014_english, t.test(second_korean - first_korean), alternative = "greater")
with(merge_2014_korean, t.test(second_korean - first_korean), alternative = "greater")
with(merge_2014_english, t.test(second_english - first_english), alternative = "greater")
with(merge_2014_math, t.test(second_math - first_math), alternative = "greater")
with(merge_2015_korean, t.test(second_korean - first_korean), alternative = "greater")
with(merge_2015_english, t.test(second_english - first_english), alternative = "greater")
with(merge_2015_math, t.test(second_math - first_math), alternative = "greater")
with(merge_2014_korean, t.test(second_korean - first_korean), alternative = "greater")
with(merge_2014_english, t.test(second_english - first_english), alternative = "greater")
with(merge_2014_math, t.test(second_math - first_math), alternative = "greater") # p-value :
with(merge_2015_korean, t.test(second_korean - first_korean), alternative = "greater") # p-value :
with(merge_2015_english, t.test(second_english - first_english), alternative = "greater") # p-value :
with(merge_2015_math, t.test(second_math - first_math), alternative = "greater") # p-value :
with(merge_2014_korean, shapiro.test(second_korean - first_korean))
exp(7.005e-13)
with(merge_2014_english, shapiro.test(second_english - first_english))
exp(7.673e-08)
with(merge_2014_english, shapiro.test(second_english - first_english)) # p-value :
with(merge_2014_math, shapiro.test(second_math - first_english))
with(merge_2014_math, shapiro.test(second_math - first_math))
with(merge_2015_korean, shapiro.test(second_korean - first_korean))
re.err.2015.korean <- getCutOff(edu_2015_re.korean, fit.re.korean) # cutoff : 0.3872484
library(XLConnect)
library(ROCR)
