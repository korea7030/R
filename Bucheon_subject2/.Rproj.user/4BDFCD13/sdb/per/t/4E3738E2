{
    "contents" : "library(XLConnect)\n# install.packages(\"ROCR\")\nlibrary(ROCR)\nfirst_2014 <- loadWorkbook('2014_1.xlsx')\nsecond_2014 <- loadWorkbook('2014_2.xlsx')\nfirst_2015 <- loadWorkbook('2015_1.xlsx')\nsecond_2015 <- loadWorkbook('2015_2.xlsx')\n\nexcept <- c(\"건축공학과\",\"실내건축학과\",\"토목공학과\",\"디지털콘텐츠학과\",\"컴퓨터소프트웨어공학과\",\"전자공학과\",\"정보통신공학과\",\"컴퓨터제어공학과\",\"e-비즈니스학과\",\"섬유의류비즈니스학과\",\"산업디자인학과\",\"패션디자인학과\",\"생활스포츠학과\",\"식품영양학과\",\"경영학과\",\"관광경영학과\",\"부동산금융정보학과\",\"비서학과\",\"세무회계학과\",\"행정학과\",\"유아교육과\",\"사회복지학과\")\nengineer <- c(\"건축과\",\"실내건축디자인과\",\"토목과\",\"컴퓨터정보보안과\",\"컴퓨터소프트웨어과\",\"전자과\",\"정보통신과\",\"지능로봇과\",\"e-비즈니스과\",\"섬유패션비즈니스과\",\"영상&게임콘텐츠과\", \"실내건축과\", \"디지털콘텐츠과\", \"모바일통신과\", \"컴퓨터제어과\", \"섬유의류비즈니스과\")\nsocial <- c(\"경영과\",\"호텔관광경영과\",\"부동산유통학과\",\"비서사무행정과\",\"세무회계과\",\"유아교육과\",\"사회복지과\",\"영유아보육과\",\"항공서비스과\", \"관광경영과\", \"부동산금융정보과\", \"비서과\", \"행정과\")\nart_psy <- c(\"광고디자인전공\",\"산업디자인과\",\"재활스포츠학과\", \"패션디자인과\", \"만화&2D영상그래픽전공\", \"3D영상그래픽전공\", \"쥬얼리디자인전공\", \"실용사진전공\", \"생활스포츠과\")\nscience <- c(\"식품영양과\",\"호텔외식조리학과\",\"간호학과\", \"호텔외식조리과\", \"간호과\")\n\n## make sheet data function\ngetSubData <- function(mainName, sheetNum) {\n  main <- eval(parse(text=mainName))\n  tmp <- readWorksheet(main, sheetNum)\n  return (tmp)\n}\n\n## get Cut off value\ngetCutOff <- function(mainData, fitData) {\n  pred <- data.frame(Direction = mainData$Direction, fit = fitData$fitted.values)\n  # get cut off \n  ob <- prediction(pred$fit, pred$Direction)\n  performance <- performance(ob, \"tpr\", \"fpr\")\n  # plot(performance)\n  err_perf <- performance(ob, \"err\")\n  plot(err_perf)\n  cut <- err_perf@x.values[[1]]\n  err <- err_perf@y.values[[1]]\n  cutoff <- cut[err == min(err)] ## cutoff value : 0.44\n  # plot(err.2014.korean~cut.2014.korean) ## cutoff graph\t\n  return (cutoff)\n}\n\n## get sheet data(2014,2015 korean, english, math) ##################\nfirst_2014_korean <- getSubData(\"first_2014\",1)\nfirst_2014_english <- getSubData(\"first_2014\",2)\nfirst_2014_math <- getSubData(\"first_2014\",3)\n\nsecond_2014_korean <- getSubData('second_2014', 1)\nsecond_2014_english <- getSubData('second_2014', 2)\nsecond_2014_math <- getSubData('second_2014', 3)\n\nfirst_2015_korean <- getSubData(\"first_2015\",1)\nfirst_2015_english <- getSubData(\"first_2015\",2)\nfirst_2015_math <- getSubData(\"first_2015\",3)\n\nsecond_2015_korean <- getSubData('second_2015', 1)\nsecond_2015_english <- getSubData('second_2015', 2)\nsecond_2015_math <- getSubData('second_2015', 3)\n############################################################\n\n## set Direction function \nsetDirection <- function(mainData, colName, value) {\n  data <- eval(parse(text=paste0(mainData,\"$\", colName)))\n  data <- value\n  return (data)\n}\n\n## setting Direction Column #####################################################\nfirst_2014_korean$Direction<- setDirection(\"first_2014_korean\", \"Direction\", 1)\nfirst_2014_english$Direction<- setDirection(\"first_2014_english\", \"Direction\", 1)\nfirst_2014_math$Direction<- setDirection(\"first_2014_math\", \"Direction\", 1)\n\nsecond_2014_korean$Direction<- setDirection(\"second_2014_korean\", \"Direction\", 1)\nsecond_2014_english$Direction<- setDirection(\"second_2014_english\", \"Direction\", 1)\nsecond_2014_math$Direction<- setDirection(\"second_2014_math\", \"Direction\", 1)\n\nfirst_2015_korean$Direction<- setDirection(\"first_2015_korean\", \"Direction\", 1)\nfirst_2015_english$Direction<- setDirection(\"first_2015_english\", \"Direction\", 1)\nfirst_2015_math$Direction<- setDirection(\"first_2015_math\", \"Direction\", 1)\n\nsecond_2015_korean$Direction<- setDirection(\"second_2015_korean\", \"Direction\", 1)\nsecond_2015_english$Direction<- setDirection(\"second_2015_english\", \"Direction\", 1)\nsecond_2015_math$Direction<- setDirection(\"second_2015_math\", \"Direction\", 1)\n#####################################################################################\n\n#### merge subject data ############################################################\nmerge_2014_korean <- merge(first_2014_korean, second_2014_korean)\nmerge_2014_english <- merge(first_2014_english, second_2014_english)\nmerge_2014_math <- merge(first_2014_math, second_2014_math)\n\nmerge_2015_korean <- merge(first_2015_korean, second_2015_korean)\nmerge_2015_english <- merge(first_2015_english, second_2015_english)\nmerge_2015_math <- merge(first_2015_math, second_2015_math)\n\n#####################################################################################\n\n#### set UP & DOWN #######################################################################################\nmerge_2014_korean$Direction[merge_2014_korean$second_korean - merge_2014_korean$first_korean > 0] <- \"UP\"\nmerge_2014_korean$Direction[merge_2014_korean$second_korean - merge_2014_korean$first_korean <= 0] <- \"DOWN\"\n\nmerge_2014_english$Direction[merge_2014_english$second_english - merge_2014_english$first_english > 0] <- \"UP\"\nmerge_2014_english$Direction[merge_2014_english$second_english - merge_2014_english$first_english <= 0] <- \"DOWN\"\n\nmerge_2014_math$Direction[merge_2014_math$second_math - merge_2014_math$first_math > 0] <- \"UP\"\nmerge_2014_math$Direction[merge_2014_math$second_math - merge_2014_math$first_math <= 0] <- \"DOWN\"\n\nmerge_2015_korean$Direction[merge_2015_korean$second_korean - merge_2015_korean$first_korean > 0] <- \"UP\"\nmerge_2015_korean$Direction[merge_2015_korean$second_korean - merge_2015_korean$first_korean <= 0] <- \"DOWN\"\n\nmerge_2015_english$Direction[merge_2015_english$second_english - merge_2015_english$first_english > 0] <- \"UP\"\nmerge_2015_english$Direction[merge_2015_english$second_english - merge_2015_english$first_english <= 0] <- \"DOWN\"\n\nmerge_2015_math$Direction[merge_2015_math$second_math - merge_2015_math$first_math > 0] <- \"UP\"\nmerge_2015_math$Direction[merge_2015_math$second_math - merge_2015_math$first_math <= 0] <- \"DOWN\"\n####################################################################################################################\n\n## except deptarment ##################################################################################\nmerge_2014_korean <- subset(merge_2014_korean, !(학과 %in% except))\nmerge_2014_english <- subset(merge_2014_english, !(학과 %in% except))\nmerge_2014_math <- subset(merge_2014_math, !(학과 %in% except))\n\nmerge_2015_korean <- subset(merge_2015_korean, !(학과 %in% except))\nmerge_2015_english <- subset(merge_2015_english, !(학과 %in% except))\nmerge_2015_math <- subset(merge_2015_math, !(학과 %in% except))\n\nmerge_2014_korean$Direction <- as.factor(merge_2014_korean$Direction)\nmerge_2014_english$Direction <- as.factor(merge_2014_english$Direction)\nmerge_2014_math$Direction <- as.factor(merge_2014_math$Direction)\n\nmerge_2015_korean$Direction <- as.factor(merge_2015_korean$Direction)\nmerge_2015_english$Direction <- as.factor(merge_2015_english$Direction)\nmerge_2015_math$Direction <- as.factor(merge_2015_math$Direction)\n\n#######################################################################################################\n\n## logistic analytics (Full Department) ##############################################################\n\n##### 2014 ###################################################################################\nfit.korean <- glm(Direction ~ second_korean, data = merge_2014_korean, family = binomial)\nsummary(fit.korean)\nexp(0.032149) # Odds : 1.032671\n\nfit.english <- glm(Direction ~ second_english, data = merge_2014_english , family = binomial)\nsummary(fit.english)\nexp(0.031749) # Odds : 1.032258\n\nfit.math <- glm(Direction~second_math, data = merge_2014_math, family = binomial)\nsummary(fit.math)\nexp(0.035350) # 1.035982\n#############################################################################################\n##### 2015 ##################################################################################\nfit.korean.2015 <- glm(Direction ~ second_korean, data = merge_2015_korean, family = binomial)\nsummary(fit.korean.2015)\nexp(0.068193) # Odds :  1.070572\n\nfit.english.2015 <- glm(Direction ~ second_english, data = merge_2015_english , family = binomial)\nsummary(fit.english.2015)\nexp(0.035152) # Odds : 1.035777\n\nfit.math.2015 <- glm(Direction~second_math, data = merge_2015_math, family = binomial)\nsummary(fit.math.2015)\nexp(0.037110) # 1.037807\n#############################################################################################\n### ErrorRate, Sensitivity, Specificity ##############################\n########### 2014 ###############################\ntable(merge_2014_korean$Direction) ## DOWN : 1038 , UP : 251\nerr.2014.korean <- getCutOff(merge_2014_korean, fit.korean) # cutoff : 0.4365607\nxtabs(~merge_2014_korean$Direction+(fit.korean$fitted.values> err.2014.korean))\n# merge_2014_korean$Direction FALSE\n#                        DOWN  1038\n#                        UP     251\ntable(merge_2014_english$Direction) ## DOWN : 656 , UP : 633\nerr.2014.english <- getCutOff(merge_2014_english, fit.english) # 0.4600607\nxtabs(~merge_2014_english$Direction+(fit.english$fitted.values > err.2014.english))\n# merge_2014_english$Direction FALSE TRUE\n#                         DOWN   384  272\n#                         UP     204  429 \n## Sensitivity = 429 / (204+429) : 0.678\n## Specificity = 384 / (384+272) : 0.585\n## Error Rate = (272+204) / (656+633) : 0.369\n\ntable(merge_2014_math$Direction) ## DOWN : 269, UP : 125\nerr.2014.math <- getCutOff(merge_2014_math, fit.math)\nxtabs(~merge_2014_math$Direction+(fit.math$fitted.values > err.2014.math))\n# merge_2014_math$Direction FALSE TRUE\n#                      DOWN   252   17\n#                      UP      98   27\n## Sensitivity = 27 / (98+27) : 0.216\n## Specificity = 252 / (252+17) : 0.936\n## Error Rate = (17+98)/ (269+125) : 0.291\n#######################################\n############## 2015 ###################\ntable(merge_2015_korean$Direction) ## DOWN : 1778  , UP : 1160\nerr.2015.korean <- getCutOff(merge_2015_korean, fit.korean.2015) # cutoff : 0.5048324\nxtabs(~merge_2015_korean$Direction+(fit.korean.2015$fitted.values> err.2015.korean))\n# merge_2015_korean$Direction FALSE TRUE\n#                        DOWN  1561  217\n#                        UP     643  517\n## Sensitivity = 517 / (643+517) : 0.446\n## Specificity = 1561 / (1561+217) : 0.878\n## Error Rate = (643+217) / (1778+1160) : 0.292\ntable(merge_2015_english$Direction) ## DOWN : 1742 , UP : 1196\nerr.2015.english <- getCutOff(merge_2015_english, fit.english.2015) # 0.4971123\nxtabs(~merge_2015_english$Direction+(fit.english.2015$fitted.values > err.2015.english))\n# merge_2015_english$Direction FALSE TRUE\n#                         DOWN  1372  370\n#                         UP     667  529 \n## Sensitivity = 529 / (667+529) : 0.442\n## Specificity = 1372 / (1372+370) : 0.788\n## Error Rate = (370+667) / (1742+1196) : 0.352\n\ntable(merge_2015_math$Direction) ## DOWN : 241, UP : 361\nerr.2015.math <- getCutOff(merge_2015_math, fit.math.2015) ## 0.5790483\nxtabs(~merge_2015_math$Direction+(fit.math.2015$fitted.values > err.2015.math))\n# merge_2015_math$Direction FALSE TRUE\n#                      DOWN   151   90\n#                      UP     102  259\n## Sensitivity = 102 / (102+259) : 0.282\n## Specificity = 151 / (151+90) : 0.626\n## Error Rate = (90+102)/ (241+361) : 0.319\n#######################################\n#####################################################################################################\n## logistic analytics (Split Department) ############################################################\nmerge_2014_korean.engineer <- subset(merge_2014_korean, 학과 %in% engineer)\nmerge_2014_korean.social <- subset(merge_2014_korean, 학과 %in% social)\nmerge_2014_korean.art_psy <- subset(merge_2014_korean, 학과 %in% art_psy)\nmerge_2014_korean.science <- subset(merge_2014_korean, 학과 %in% science)\n\nmerge_2014_english.engineer <- subset(merge_2014_english, 학과 %in% engineer)\nmerge_2014_english.social <- subset(merge_2014_english, 학과 %in% social)\nmerge_2014_english.art_psy <- subset(merge_2014_english, 학과 %in% art_psy)\nmerge_2014_english.science <- subset(merge_2014_english, 학과 %in% science)\n\nmerge_2014_math.engineer <- subset(merge_2014_math, 학과 %in% engineer)\n\nmerge_2015_korean.engineer <- subset(merge_2015_korean, 학과 %in% engineer)\nmerge_2015_korean.social <- subset(merge_2015_korean, 학과 %in% social)\nmerge_2015_korean.art_psy <- subset(merge_2015_korean, 학과 %in% art_psy)\nmerge_2015_korean.science <- subset(merge_2015_korean, 학과 %in% science)\n\nmerge_2015_english.engineer <- subset(merge_2015_english, 학과 %in% engineer)\nmerge_2015_english.social <- subset(merge_2015_english, 학과 %in% social)\nmerge_2015_english.art_psy <- subset(merge_2015_english, 학과 %in% art_psy)\nmerge_2015_english.science <- subset(merge_2015_english, 학과 %in% science)\n\nmerge_2015_math.engineer <- subset(merge_2015_math, 학과 %in% engineer)\n\n####### korean split Department ########################################################################################\nfit.korean.engineer.2014 <- glm(Direction ~ second_korean, data = merge_2014_korean.engineer, family = binomial)\nsummary(fit.korean.engineer.2014)\nexp(0.03208) # Odds : 1.0326\n\nfit.korean.social.2014 <- glm(Direction ~ second_korean, data = merge_2014_korean.social, family = binomial)\nsummary(fit.korean.social.2014)\nexp(0.03111) # Odds : 1.031599\n\nfit.korean.art_psy.2014 <- glm(Direction ~ second_korean, data = merge_2014_korean.art_psy, family = binomial)\nsummary(fit.korean.art_psy.2014)\nexp(0.01995) # Odds : 1.02015\n\nfit.korean.science.2014 <- glm(Direction ~ second_korean, data = merge_2014_korean.science, family = binomial)\nsummary(fit.korean.science.2014)\nexp(0.03352) # Odds : 1.034088\n\nfit.korean.engineer.2015 <- glm(Direction ~ second_korean, data = merge_2015_korean.engineer, family = binomial)\nsummary(fit.korean.engineer.2015)\nexp(0.075161) # Odds : 1.078058\n\nfit.korean.social.2015 <- glm(Direction ~ second_korean, data = merge_2015_korean.social, family = binomial)\nsummary(fit.korean.social.2015)\nexp(0.084215) # Odds : 1.087863\n\nfit.korean.art_psy.2015 <- glm(Direction ~ second_korean, data = merge_2015_korean.art_psy, family = binomial)\nsummary(fit.korean.art_psy.2015)\nexp(0.027845) # Odds : 1.028236\n\nfit.korean.science.2015 <- glm(Direction ~ second_korean, data = merge_2015_korean.science, family = binomial)\nsummary(fit.korean.science.2015)\nexp(0.06626) # Odds : 1.068504\n##################################################################################################################################\n\n#### Error Rate (2014,2015 split department korean) #############################\ntable(merge_2014_korean.engineer$Direction) ## DOWN : 451 , UP : 165\nerr.2014.korean.engineer <- getCutOff(merge_2014_korean.engineer, fit.korean.engineer.2014) # 0.4996522\nxtabs(~merge_2014_korean.engineer$Direction+(fit.korean.engineer.2014$fitted.values > err.2014.korean.engineer))\n# merge_2014_korean.engineer$Direction FALSE TRUE\n#                                 DOWN   451    0\n#                                 UP     164    1\n## \n## Sensitivity = 1 / (164+1) : 0.006\n## Specificity = 451 / (451+0) : 1\n## Error Rate = (0+164)/ (451+165) : 0.267\ntable(merge_2014_korean.social$Direction) ## DOWN : 298 , UP : 45\nerr.2014.korean.social <- getCutOff(merge_2014_korean.social, fit.korean.social.2014) # Inf???\nxtabs(~merge_2014_korean.social$Direction+(fit.korean.social.2014$fitted.values > err.2014.korean.social))\n# merge_2014_korean.engineer$Direction FALSE \n#                                 DOWN   298 \n#                                 UP     45 \n## \n## Sensitivity = ?\n## Specificity = ?\n## Error Rate = ?\ntable(merge_2014_korean.art_psy$Direction) ## DOWN : 111 , UP : 21\nerr.2014.korean.art_psy <- getCutOff(merge_2014_korean.art_psy, fit.korean.art_psy.2014) # 0.2574862\nxtabs(~merge_2014_korean.art_psy$Direction+(fit.korean.art_psy.2014$fitted.values > err.2014.korean.art_psy))\n# merge_2014_korean.engineer$Direction FALSE \n#                                 DOWN   111 \n#                                 UP      21 \n## \n## Sensitivity = ?\n## Specificity = ?\n## Error Rate = ?\ntable(merge_2014_korean.science$Direction) ## DOWN : 120 , UP : 19\nerr.2014.korean.science <- getCutOff(merge_2014_korean.science, fit.korean.science.2014) # Inf\nxtabs(~merge_2014_korean.science$Direction+(fit.korean.science.2014$fitted.values > err.2014.korean.science))\n# merge_2014_korean.engineer$Direction FALSE\n#                                 DOWN   120\n#                                 UP      19\n## \n## Sensitivity = ?\n## Specificity = ?\n## Error Rate = ?\n################################################################\n###### english split Department ##################################################################################################\nfit.english.engineer.2014 <- glm(Direction ~ second_english, data = merge_2014_english.engineer, family = binomial)\nsummary(fit.english.engineer.2014)\nexp(0.037955) # Odds : 1.038684\n\nfit.english.social.2014 <- glm(Direction ~ second_english, data = merge_2014_english.social, family = binomial)\nsummary(fit.english.social.2014)\nexp(0.027987) # Odds : 1.028382\n\nfit.english.art_psy.2014 <- glm(Direction ~ second_english, data = merge_2014_english.art_psy, family = binomial)\nsummary(fit.english.art_psy.2014)\nexp(0.022455) # Odds : 1.022709\n\nfit.english.science.2014 <- glm(Direction ~ second_english, data = merge_2014_english.science, family = binomial)\nsummary(fit.english.science.2014)\nexp(0.023027) # Odds : 1.023294\n\nfit.english.engineer.2015 <- glm(Direction ~ second_english, data = merge_2015_english.engineer, family = binomial)\nsummary(fit.english.engineer.2015)\nexp(0.042827) # Odds : 1.043757\n\nfit.english.social.2015 <- glm(Direction ~ second_english, data = merge_2015_english.social, family = binomial)\nsummary(fit.english.social.2015)\nexp(0.031959) # Odds : 1.032475\n\nfit.english.art_psy.2015 <- glm(Direction ~ second_english, data = merge_2015_english.art_psy, family = binomial)\nsummary(fit.english.art_psy.2015)\nexp(0.028470) # Odds : 1.028879\n\nfit.english.science.2015 <- glm(Direction ~ second_english, data = merge_2015_english.science, family = binomial)\nsummary(fit.english.science.2015)\nexp(0.020457) # Odds : 1.020668\n\n########################################################################################################################################\n####### math split Department(Only engineer ) ##########################################################################################################\nfit.math.engineer.2014 <- glm(Direction ~ second_math, data = merge_2014_math.engineer, family = binomial)\nsummary(fit.math.engineer.2014)\nexp(0.035350) # Odds : 1.035982\n\nfit.math.engineer.2015 <- glm(Direction ~ second_math, data = merge_2015_math.engineer, family = binomial)\nsummary(fit.math.engineer.2015)\nexp(0.037110) # Odds : 1.037807\n\n########################################################################################################################################\n\n######## quantile (Full Department)##############################################################################################\nquan_30_korean.2014 <- quantile(merge_2014_korean$second_korean, c(0,0.3,0.5, 0.7,1.0))\nquan_30_english.2014 <- quantile(merge_2014_english$second_english, c(0,0.3,0.5, 0.7,1.0))\nquan_30_math.2014 <- quantile(merge_2014_math$second_math, c(0,0.3,0.5, 0.7,1.0))\n\nquan_30_korean.2015 <- quantile(merge_2015_korean$second_korean, c(0,0.3,0.5, 0.7,1.0))\nquan_30_english.2015 <- quantile(merge_2015_english$second_english, c(0,0.3,0.5, 0.7,1.0))\nquan_30_math.2015 <- quantile(merge_2015_math$second_math, c(0,0.3,0.5, 0.7,1.0))\n\nquan_40_korean.2014 <- quantile(merge_2014_korean$second_korean, c(0,0.2,0.4,0.6,0.8,1.0))\nquan_40_english.2014 <- quantile(merge_2014_english$second_english, c(0,0.2,0.4,0.6,0.8,1.0))\nquan_40_math.2014 <- quantile(merge_2014_math$second_math, c(0,0.2,0.4,0.6,0.8,1.0))\n\nquan_40_korean.2015 <- quantile(merge_2015_korean$second_korean, c(0,0.2,0.4,0.6,0.8,1.0))\nquan_40_english.2015 <- quantile(merge_2015_english$second_english, c(0,0.2,0.4,0.6,0.8,1.0))\nquan_40_math.2015 <- quantile(merge_2015_math$second_math, c(0,0.2,0.4,0.6,0.8,1.0))\n\n\n#### high 30% #############################################################################################\nmerge_2014_korean_UP30<- merge_2014_korean[merge_2014_korean$second_korean >= quan_30_korean.2014[4],]\nmerge_2014_english_UP30<- merge_2014_english[merge_2014_english$second_english >= quan_30_english.2014[4],]\nmerge_2014_math_UP30<- merge_2014_math[merge_2014_math$second_math >= quan_30_math.2014[4],]\n\nmerge_2015_korean_UP30<- merge_2015_korean[merge_2015_korean$second_korean >= quan_30_korean.2014[4],]\nmerge_2015_english_UP30<- merge_2015_english[merge_2015_english$second_english >= quan_30_english.2014[4],]\nmerge_2015_math_UP30<- merge_2015_math[merge_2015_math$second_math >= quan_30_math.2014[4],]\n\n########## 2014 ###########################################################################\nfit.UP30.korean.2014 <- glm(Direction~second_korean, data = merge_2014_korean_UP30, family = binomial)\nsummary(fit.UP30.korean.2014)\nexp(0.03074) # 1.031217\n\nfit.UP30.english.2014 <- glm(Direction~second_english, data = merge_2014_english_UP30, family = binomial)\nsummary(fit.UP30.english.2014)\nexp(0.02390) # 1.024188\n\nfit.UP30.math.2014 <- glm(Direction~second_math, data = merge_2014_math_UP30, family = binomial)\nsummary(fit.UP30.math.2014)\nexp(0.02894) # 1.029363\n###########################################################################################\n########## 2015 ###########################################################################\nfit.UP30.korean.2015 <- glm(Direction~second_korean, data = merge_2015_korean_UP30, family = binomial)\nsummary(fit.UP30.korean.2015)\nexp(0.08892) # 1.092993\n\nfit.UP30.english.2015 <- glm(Direction~second_english, data = merge_2015_english_UP30, family = binomial)\nsummary(fit.UP30.english.2015)\nexp(0.03285) # 1.033396\n\nfit.UP30.math.2015 <- glm(Direction~second_math, data = merge_2015_math_UP30, family = binomial)\nsummary(fit.UP30.math.2015)\nexp(0.06496) # 1.067116\n###########################################################################################\n#### Error Rate ####################################################################\n#### 2014 ######################################################################\ntable(merge_2014_korean_UP30$Direction) ## DOWN : 412 , UP : 148\nerr.2014.UP30.korean <- getCutOff(merge_2014_korean_UP30, fit.UP30.korean.2014) # 0.4216374\nxtabs(~merge_2014_korean_UP30$Direction+(fit.UP30.korean.2014$fitted.values > err.2014.UP30.korean))\n# merge_2014_korean.engineer$Direction FALSE\n#                                 DOWN   412\n#                                 UP     148\n## \n## Sensitivity = ?\n## Specificity = ?\n## Error Rate = ?\ntable(merge_2014_english_UP30$Direction) ## DOWN : 157 , UP : 282\nerr.2014.UP30.english <- getCutOff(merge_2014_english_UP30, fit.UP30.english.2014) # 0.5946994\nxtabs(~merge_2014_english_UP30$Direction+(fit.UP30.english.2014$fitted.values > err.2014.UP30.english))\n# merge_2014_english.engineer$Direction FALSE TRUE\n#                                 DOWN    37   120\n#                                 UP      78   204\n## \n## Sensitivity = 204 / (78+204) : 0.723\n## Specificity = 37 / (37+120) : 0.236\n## Error Rate =  (120+78) / (157+282) : 0.451\ntable(merge_2014_math_UP30$Direction) ## DOWN : 73 , UP : 73\nerr.2014.UP30.math <- getCutOff(merge_2014_math_UP30, fit.UP30.math.2014) # 0.5221217\nxtabs(~merge_2014_math_UP30$Direction+(fit.UP30.math.2014$fitted.values > err.2014.UP30.math))\n# merge_2014_math.engineer$Direction   FALSE TRUE\n#                                 DOWN    56   17\n#                                 UP      46   27\n## \n## Sensitivity = 27 / (46+27) : 0.369863\n## Specificity = 56 / (56+17) : 0.7671233\n## Error Rate = (17+46) / (73+73) : 0.4315068\n################################################################################\n#### 2015 ######################################################################\ntable(merge_2015_korean_UP30$Direction) ## DOWN : 217 , UP : 517\nerr.2015.UP30.korean <- getCutOff(merge_2015_korean_UP30, fit.UP30.korean.2015) # 0.6204663\nxtabs(~merge_2015_korean_UP30$Direction+(fit.UP30.korean.2015$fitted.values > err.2015.UP30.korean))\n# merge_2015_korean.engineer$Direction FALSE TRUE\n#                                 DOWN   119   98\n#                                 UP     197  320\n## \n## Sensitivity = 320 / (197+320) : 0.619\n## Specificity = 119 / (119+98) : 0.548\n## Error Rate = (98+197) / (217+517) : 0.4019074\ntable(merge_2015_english_UP30$Direction) ## DOWN : 488 , UP : 655\nerr.2015.UP30.english <- getCutOff(merge_2015_english_UP30, fit.UP30.english.2015) # 0.4922861\nxtabs(~merge_2015_english_UP30$Direction+(fit.UP30.english.2015$fitted.values > err.2015.UP30.english))\n# merge_2015_english.engineer$Direction FALSE TRUE\n#                                 DOWN   118   370\n#                                 UP     126   529\n## \n## Sensitivity = 529 / (529+126) : 0.808\n## Specificity = 118 / (118+370) : 0.241\n## Error Rate =  (370+126) / (488+655) : 0.434\ntable(merge_2015_math_UP30$Direction) ## DOWN : 90 , UP : 259\nerr.2015.UP30.math <- getCutOff(merge_2015_math_UP30, fit.UP30.math.2015) # 0.5181663\nxtabs(~merge_2015_math_UP30$Direction+(fit.UP30.math.2015$fitted.values > err.2015.UP30.math))\n# merge_2015_math.engineer$Direction   FALSE TRUE\n#                                 DOWN    22   68\n#                                 UP      23  236\n## \n## Sensitivity = 236 / (23+236) : 0.911\n## Specificity = 22 / (22+68) : 0.244\n## Error Rate = (68+23) / (90+259) : 0.261\n################################################################################\n####################################################################################\n\n##########################################################################################################\n#### Lower 30% #################################################################################\nmerge_2014_korean_DOWN30<- merge_2014_korean[merge_2014_korean$second_korean <= quan_30_korean.2014[2],]\nmerge_2014_english_DOWN30<- merge_2014_english[merge_2014_english$second_english <= quan_30_english.2014[2],]\nmerge_2014_math_DOWN30<- merge_2014_math[merge_2014_math$second_math <= quan_30_math.2014[2],]\n\nmerge_2015_korean_DOWN30<- merge_2015_korean[merge_2015_korean$second_korean <= quan_30_korean.2014[2],]\nmerge_2015_english_DOWN30<- merge_2015_english[merge_2015_english$second_english <= quan_30_english.2014[2],]\nmerge_2015_math_DOWN30<- merge_2015_math[merge_2015_math$second_math <= quan_30_math.2014[2],]\n\n########## 2014 ###########################################################################\nfit.DOWN30.korean.2014 <- glm(Direction~second_korean, data = merge_2014_korean_DOWN30, family = binomial)\nsummary(fit.DOWN30.korean.2014)\nexp(0.05382) # 1.055295\n\nfit.DOWN30.english.2014 <- glm(Direction~second_english, data = merge_2014_english_DOWN30, family = binomial)\nsummary(fit.DOWN30.english.2014)\nexp(0.10278) # 1.108248\n\nfit.DOWN30.math.2014 <- glm(Direction~second_math, data = merge_2014_math_DOWN30, family = binomial)\nsummary(fit.DOWN30.math.2014)\nexp(0.09738) # 1.102279\n###########################################################################################\n########## 2015 ###########################################################################\nfit.DOWN30.korean.2015 <- glm(Direction~second_korean, data = merge_2015_korean_DOWN30, family = binomial)\nsummary(fit.DOWN30.korean.2015)\nexp(0.03967) # 1.040467\n\nfit.DOWN30.english.2015 <- glm(Direction~second_english, data = merge_2015_english_DOWN30, family = binomial)\nsummary(fit.DOWN30.english.2015)\nexp(0.08289) # 1.086422\n\nfit.DOWN30.math.2015 <- glm(Direction~second_math, data = merge_2015_math_DOWN30, family = binomial)\nsummary(fit.DOWN30.math.2015)\nexp(0.05346) # 1.054915\n###########################################################################################\n##### Error Rate ##########################################################################\n#### 2014 ######################################################################\ntable(merge_2014_korean_DOWN30$Direction) ## DOWN : 390 , DOWN : 50\nerr.2014.DOWN30.korean <- getCutOff(merge_2014_korean_DOWN30, fit.DOWN30.korean.2014) # Inf\nxtabs(~merge_2014_korean_DOWN30$Direction+(fit.DOWN30.korean.2014$fitted.values > err.2014.DOWN30.korean))\n# merge_2014_korean.engineer$Direction FALSE\n#                                 DOWN   390\n#                                 UP      50\n## \n## Sensitivity = ?\n## Specificity = ?\n## Error Rate = ?\ntable(merge_2014_english_DOWN30$Direction) ## DOWN : 311 , DOWN : 125\nerr.2014.DOWN30.english <- getCutOff(merge_2014_english_DOWN30, fit.DOWN30.english.2014) # Inf 0.5663065\nxtabs(~merge_2014_english_DOWN30$Direction+(fit.DOWN30.english.2014$fitted.values > err.2014.DOWN30.english))\n# merge_2014_english.engineer$Direction FALSE\n#                                 DOWN    311 \n#                                 UP      125 \n## \n## Sensitivity = ?\n## Specificity = ?\n## Error Rate =  ?\ntable(merge_2014_math_DOWN30$Direction) ## DOWN : 108 , DOWN : 19\nerr.2014.DOWN30.math <- getCutOff(merge_2014_math_DOWN30, fit.DOWN30.math.2014) # Inf\nxtabs(~merge_2014_math_DOWN30$Direction+(fit.DOWN30.math.2014$fitted.values > err.2014.DOWN30.math))\n# merge_2014_math.engineer$Direction   FALSE\n#                                 DOWN   108\n#                                 UP      19\n## \n## Sensitivity = ?\n## Specificity = ?\n## Error Rate = ?\n################################################################################\n#### 2015 ######################################################################\ntable(merge_2015_korean_DOWN30$Direction) ## DOWN : 1079 , DOWN : 285\nerr.2015.DOWN30.korean <- getCutOff(merge_2015_korean_DOWN30, fit.DOWN30.korean.2015) # Inf\nxtabs(~merge_2015_korean_DOWN30$Direction+(fit.DOWN30.korean.2015$fitted.values > err.2015.DOWN30.korean))\n# merge_2015_korean.engineer$Direction FALSE\n#                                 DOWN  1079\n#                                 UP     285\n## \n## Sensitivity = ?\n## Specificity = ?\n## Error Rate = ?\ntable(merge_2015_english_DOWN30$Direction) ## DOWN : 629 , DOWN : 134\nerr.2015.DOWN30.english <- getCutOff(merge_2015_english_DOWN30, fit.DOWN30.english.2015) # Inf\nxtabs(~merge_2015_english_DOWN30$Direction+(fit.DOWN30.english.2015$fitted.values > err.2015.DOWN30.english))\n# merge_2015_english.engineer$Direction FALSE\n#                                 DOWN   629 \n#                                 UP     134 \n## \n## Sensitivity = ?\n## Specificity = ?\n## Error Rate =  ?\ntable(merge_2015_math_DOWN30$Direction) ## DOWN : 81 , DOWN : 30\nerr.2015.DOWN30.math <- getCutOff(merge_2015_math_DOWN30, fit.DOWN30.math.2015) # Inf\nxtabs(~merge_2015_math_DOWN30$Direction+(fit.DOWN30.math.2015$fitted.values > err.2015.DOWN30.math))\n# merge_2015_math.engineer$Direction   FALSE\n#                                 DOWN    81\n#                                 UP      30\n## \n## Sensitivity = ?\n## Specificity = ?\n## Error Rate = ?\n################################################################################\n###########################################################################################\n###############################################################################################\n#### Lower 40% #################################################################################\nmerge_2014_korean_DOWN40<- merge_2014_korean[merge_2014_korean$second_korean <= quan_40_korean.2014[3],]\nmerge_2014_english_DOWN40<- merge_2014_english[merge_2014_english$second_english <= quan_40_english.2014[3],]\nmerge_2014_math_DOWN40<- merge_2014_math[merge_2014_math$second_math <= quan_40_math.2014[3],]\n\nmerge_2015_korean_DOWN40<- merge_2015_korean[merge_2015_korean$second_korean <= quan_40_korean.2014[3],]\nmerge_2015_english_DOWN40<- merge_2015_english[merge_2015_english$second_english <= quan_40_english.2014[3],]\nmerge_2015_math_DOWN40<- merge_2015_math[merge_2015_math$second_math <= quan_40_math.2014[3],]\n\n########## 2014 ###########################################################################\nfit.DOWN40.korean.2014 <- glm(Direction~second_korean, data = merge_2014_korean_DOWN40, family = binomial)\nsummary(fit.DOWN40.korean.2014)\nexp(0.03996) # 1.040769\n\nfit.DOWN40.english.2014 <- glm(Direction~second_english, data = merge_2014_english_DOWN40, family = binomial)\nsummary(fit.DOWN40.english.2014)\nexp(0.070622) # 1.073175\n\nfit.DOWN40.math.2014 <- glm(Direction~second_math, data = merge_2014_math_DOWN40, family = binomial)\nsummary(fit.DOWN40.math.2014)\nexp(0.07578) # 1.078725\n###########################################################################################\n########## 2015 ###########################################################################\nfit.DOWN40.korean.2015 <- glm(Direction~second_korean, data = merge_2015_korean_DOWN40, family = binomial)\nsummary(fit.DOWN40.korean.2015)\nexp(0.042612) # 1.040467\n\nfit.DOWN40.english.2015 <- glm(Direction~second_english, data = merge_2015_english_DOWN40, family = binomial)\nsummary(fit.DOWN40.english.2015)\nexp(0.055975) # 1.057571\n\nfit.DOWN40.math.2015 <- glm(Direction~second_math, data = merge_2015_math_DOWN40, family = binomial)\nsummary(fit.DOWN40.math.2015)\nexp(0.09408) # 1.098648\n###########################################################################################\n##### Error Rate ##########################################################################\n#### 2014 ######################################################################\ntable(merge_2014_korean_DOWN40$Direction) ## DOWN : 500 , DOWN : 70\nerr.2014.DOWN40.korean <- getCutOff(merge_2014_korean_DOWN40, fit.DOWN40.korean.2014) # Inf\nxtabs(~merge_2014_korean_DOWN40$Direction+(fit.DOWN40.korean.2014$fitted.values > err.2014.DOWN40.korean))\n# merge_2014_korean.engineer$Direction FALSE\n#                                 DOWN   500\n#                                 UP      70\n## \n## Sensitivity = ?\n## Specificity = ?\n## Error Rate = ?\ntable(merge_2014_english_DOWN40$Direction) ## DOWN : 384 , DOWN : 204\nerr.2014.DOWN40.english <- getCutOff(merge_2014_english_DOWN40, fit.DOWN40.english.2014) # 0.6279284\nxtabs(~merge_2014_english_DOWN40$Direction+(fit.DOWN40.english.2014$fitted.values > err.2014.DOWN40.english))\n# merge_2014_english.engineer$Direction FALSE\n#                                 DOWN    384 \n#                                 UP      204 \n## \n## Sensitivity = ?\n## Specificity = ?\n## Error Rate =  ?\ntable(merge_2014_math_DOWN40$Direction) ## DOWN : 134 , DOWN : 28\nerr.2014.DOWN40.math <- getCutOff(merge_2014_math_DOWN40, fit.DOWN40.math.2014) # Inf\nxtabs(~merge_2014_math_DOWN40$Direction+(fit.DOWN40.math.2014$fitted.values > err.2014.DOWN40.math))\n# merge_2014_math.engineer$Direction   FALSE\n#                                 DOWN   134\n#                                 UP      28\n## \n## Sensitivity = ?\n## Specificity = ?\n## Error Rate = ?\n################################################################################\n#### 2015 ######################################################################\ntable(merge_2015_korean_DOWN40$Direction) ## DOWN : 1357 , DOWN : 438\nerr.2015.DOWN40.korean <- getCutOff(merge_2015_korean_DOWN40, fit.DOWN40.korean.2015) # Inf\nxtabs(~merge_2015_korean_DOWN40$Direction+(fit.DOWN40.korean.2015$fitted.values > err.2015.DOWN40.korean))\n# merge_2015_korean.engineer$Direction FALSE\n#                                 DOWN  1357\n#                                 UP     438\n## \n## Sensitivity = ?\n## Specificity = ?\n## Error Rate = ?\ntable(merge_2015_english_DOWN40$Direction) ## DOWN : 854 , DOWN : 251\nerr.2015.DOWN40.english <- getCutOff(merge_2015_english_DOWN40, fit.DOWN40.english.2015) # Inf\nxtabs(~merge_2015_english_DOWN40$Direction+(fit.DOWN40.english.2015$fitted.values > err.2015.DOWN40.english))\n# merge_2015_english.engineer$Direction FALSE\n#                                 DOWN   854 \n#                                 UP     251 \n## \n## Sensitivity = ?\n## Specificity = ?\n## Error Rate =  ?\ntable(merge_2015_math_DOWN40$Direction) ## DOWN : 89 , DOWN : 53\nerr.2015.DOWN40.math <- getCutOff(merge_2015_math_DOWN40, fit.DOWN40.math.2015) # 0.6369208\nxtabs(~merge_2015_math_DOWN40$Direction+(fit.DOWN40.math.2015$fitted.values > err.2015.DOWN40.math))\n# merge_2015_math.engineer$Direction   FALSE\n#                                 DOWN    89\n#                                 UP      53\n## \n## Sensitivity = ?\n## Specificity = ?\n## Error Rate = ?\n################################################################################\n###########################################################################################\n#########################################################################################################################################\n######## quantile (split Department) ####################################################################################################\nquan_30_korean.2014.engineer <- quantile(merge_2014_korean.engineer$second_korean, c(0,0.3,0.5,0.7,1.0))\nquan_30_korean.2014.social <- quantile(merge_2014_korean.social$second_korean, c(0,0.3,0.5,0.7,1.0))\nquan_30_korean.2014.art_psy <- quantile(merge_2014_korean.art_psy$second_korean, c(0,0.3,0.5,0.7,1.0))\nquan_30_korean.2014.science <- quantile(merge_2014_korean.science$second_korean, c(0,0.3,0.5,0.7,1.0))\n\nquan_30_english.2014.engineer <- quantile(merge_2014_english.engineer$second_english, c(0,0.3,0.5,0.7,1.0))\nquan_30_english.2014.social <- quantile(merge_2014_english.social$second_english, c(0,0.3,0.5,0.7,1.0))\nquan_30_english.2014.art_psy <- quantile(merge_2014_english.art_psy$second_english, c(0,0.3,0.5,0.7,1.0))\nquan_30_english.2014.science <- quantile(merge_2014_english.science$second_english, c(0,0.3,0.5,0.7,1.0))\n\nquan_30_math.2014.engineer <- quantile(merge_2014_math.engineer$second_math, c(0,0.3,0.5,0.7,1.0))\n\nquan_30_korean.2015.engineer <- quantile(merge_2015_korean.engineer$second_korean, c(0,0.3,0.5,0.7,1.0))\nquan_30_korean.2015.social <- quantile(merge_2015_korean.social$second_korean, c(0,0.3,0.5,0.7,1.0))\nquan_30_korean.2015.art_psy <- quantile(merge_2015_korean.art_psy$second_korean, c(0,0.3,0.5,0.7,1.0))\nquan_30_korean.2015.science <- quantile(merge_2015_korean.science$second_korean, c(0,0.3,0.5,0.7,1.0))\n\nquan_30_english.2015.engineer <- quantile(merge_2015_english.engineer$second_english, c(0,0.3,0.5,0.7,1.0))\nquan_30_english.2015.social <- quantile(merge_2015_english.social$second_english, c(0,0.3,0.5,0.7,1.0))\nquan_30_english.2015.art_psy <- quantile(merge_2015_english.art_psy$second_english, c(0,0.3,0.5,0.7,1.0))\nquan_30_english.2015.science <- quantile(merge_2015_english.science$second_english, c(0,0.3,0.5,0.7,1.0))\n\nquan_30_math.2015.engineer <- quantile(merge_2015_math.engineer$second_math, c(0,0.3,0.5,0.7,1.0))\n\nquan_40_korean.2014.engineer <- quantile(merge_2014_korean.engineer$second_korean, c(0,0.2,0.4,0.6,0.8,1.0))\nquan_40_korean.2014.social <- quantile(merge_2014_korean.social$second_korean, c(0,0.2,0.4,0.6,0.8,1.0))\nquan_40_korean.2014.art_psy <- quantile(merge_2014_korean.art_psy$second_korean, c(0,0.2,0.4,0.6,0.8,1.0))\nquan_40_korean.2014.science <- quantile(merge_2014_korean.science$second_korean, c(0,0.2,0.4,0.6,0.8,1.0))\n\nquan_40_english.2014.engineer <- quantile(merge_2014_english.engineer$second_english, c(0,0.2,0.4,0.6,0.8,1.0))\nquan_40_english.2014.social <- quantile(merge_2014_english.social$second_english, c(0,0.2,0.4,0.6,0.8,1.0))\nquan_40_english.2014.art_psy <- quantile(merge_2014_english.art_psy$second_english, c(0,0.2,0.4,0.6,0.8,1.0))\nquan_40_english.2014.science <- quantile(merge_2014_english.science$second_english, c(0,0.2,0.4,0.6,0.8,1.0))\n\nquan_40_math.2014.engineer <- quantile(merge_2014_math.engineer$second_math, c(0,0.2,0.4,0.6,0.8,1.0))\n\nquan_40_korean.2015.engineer <- quantile(merge_2015_korean.engineer$second_korean, c(0,0.2,0.4,0.6,0.8,1.0))\nquan_40_korean.2015.social <- quantile(merge_2015_korean.social$second_korean, c(0,0.2,0.4,0.6,0.8,1.0))\nquan_40_korean.2015.art_psy <- quantile(merge_2015_korean.art_psy$second_korean, c(0,0.2,0.4,0.6,0.8,1.0))\nquan_40_korean.2015.science <- quantile(merge_2015_korean.science$second_korean, c(0,0.2,0.4,0.6,0.8,1.0))\n\nquan_40_english.2015.engineer <- quantile(merge_2015_english.engineer$second_english, c(0,0.2,0.4,0.6,0.8,1.0))\nquan_40_english.2015.social <- quantile(merge_2015_english.social$second_english, c(0,0.2,0.4,0.6,0.8,1.0))\nquan_40_english.2015.art_psy <- quantile(merge_2015_english.art_psy$second_english, c(0,0.2,0.4,0.6,0.8,1.0))\nquan_40_english.2015.science <- quantile(merge_2015_english.science$second_english, c(0,0.2,0.4,0.6,0.8,1.0))\n\nquan_40_math.2015.engineer <- quantile(merge_2015_math.engineer$second_math, c(0,0.2,0.4,0.6,0.8,1.0))\n\n##### High 30% (split Department) #######################################################################\nmerge_2014_korean_UP30.engineer<- merge_2014_korean.engineer[merge_2014_korean.engineer$second_korean >= quan_30_korean.2014.engineer[4],]\nmerge_2014_korean_UP30.social<- merge_2014_korean.social[merge_2014_korean.social$second_korean >= quan_30_korean.2014.social[4],]\nmerge_2014_korean_UP30.art_psy<- merge_2014_korean.art_psy[merge_2014_korean.art_psy$second_korean >= quan_30_korean.2014.art_psy[4],]\nmerge_2014_korean_UP30.science<- merge_2014_korean.science[merge_2014_korean.science$second_korean >= quan_30_korean.2014.science[4],]\n\nmerge_2015_korean_UP30.engineer<- merge_2015_korean.engineer[merge_2015_korean.engineer$second_korean >= quan_30_korean.2015.engineer[4],]\nmerge_2015_korean_UP30.social<- merge_2015_korean.social[merge_2015_korean.social$second_korean >= quan_30_korean.2015.social[4],]\nmerge_2015_korean_UP30.art_psy<- merge_2015_korean.art_psy[merge_2015_korean.art_psy$second_korean >= quan_30_korean.2015.art_psy[4],]\nmerge_2015_korean_UP30.science<- merge_2015_korean.science[merge_2015_korean.science$second_korean >= quan_30_korean.2015.science[4],]\n\nmerge_2014_english_UP30.engineer<- merge_2014_english.engineer[merge_2014_english.engineer$second_english >= quan_30_english.2014.engineer[4],]\nmerge_2014_english_UP30.social<- merge_2014_english.social[merge_2014_english.social$second_english >= quan_30_english.2014.social[4],]\nmerge_2014_english_UP30.art_psy<- merge_2014_english.art_psy[merge_2014_english.art_psy$second_english >= quan_30_english.2014.art_psy[4],]\nmerge_2014_english_UP30.science<- merge_2014_english.science[merge_2014_english.science$second_english >= quan_30_english.2014.science[4],]\n\nmerge_2015_english_UP30.engineer<- merge_2015_english.engineer[merge_2015_english.engineer$second_english >= quan_30_english.2015.engineer[4],]\nmerge_2015_english_UP30.social<- merge_2015_english.social[merge_2015_english.social$second_english >= quan_30_english.2015.social[4],]\nmerge_2015_english_UP30.art_psy<- merge_2015_english.art_psy[merge_2015_english.art_psy$second_english >= quan_30_english.2015.art_psy[4],]\nmerge_2015_english_UP30.science<- merge_2015_english.science[merge_2015_english.science$second_english >= quan_30_english.2015.science[4],]\n\nmerge_2014_math_UP30.engineer<- merge_2014_math.engineer[merge_2014_math.engineer$second_math >= quan_30_math.2014.engineer[4],]\n\nmerge_2015_math_UP30.engineer<- merge_2015_math.engineer[merge_2015_math.engineer$second_math >= quan_30_math.2015.engineer[4],]\n\n########## 2014 ###########################################################################\nfit.UP30.korean.2014.engineer <- glm(Direction~second_korean, data = merge_2014_korean_UP30.engineer, family = binomial)\nsummary(fit.UP30.korean.2014.engineer)\nexp(0.04100) # 1.041852\n\nfit.UP30.korean.2014.social <- glm(Direction~second_korean, data = merge_2014_korean_UP30.social, family = binomial)\nsummary(fit.UP30.korean.2014.social)\nexp(0.07147) # 1.074086\n\nfit.UP30.korean.2014.art_psy <- glm(Direction~second_korean, data = merge_2014_korean_UP30.art_psy, family = binomial)\nsummary(fit.UP30.korean.2014.art_psy)\nexp(0.14563) # 1.156768\n\nfit.UP30.korean.2014.science <- glm(Direction~second_korean, data = merge_2014_korean_UP30.science, family = binomial)\nsummary(fit.UP30.korean.2014.science)\nexp(-0.02042) # 0.9797871\n\nfit.UP30.english.2014.engineer <- glm(Direction~second_english, data = merge_2014_english_UP30.engineer, family = binomial)\nsummary(fit.UP30.english.2014.engineer)\nexp(-0.00450) # 0.9955101\n\nfit.UP30.english.2014.social <- glm(Direction~second_english, data = merge_2014_english_UP30.social, family = binomial)\nsummary(fit.UP30.english.2014.social)\nexp(0.06122) # 1.063133\n\nfit.UP30.english.2014.art_psy <- glm(Direction~second_english, data = merge_2014_english_UP30.art_psy, family = binomial)\nsummary(fit.UP30.english.2014.art_psy)\nexp(0.04936) # 1.050598\n\nfit.UP30.english.2014.science <- glm(Direction~second_english, data = merge_2014_english_UP30.science, family = binomial)\nsummary(fit.UP30.english.2014.science)\nexp(-0.007706) # 0.9923236\n\nfit.UP30.math.2014.engineer <- glm(Direction~second_math, data = merge_2014_math_UP30.engineer, family = binomial)\nsummary(fit.UP30.math.2014.engineer)\nexp(0.02894) # 1.029363\n\n###########################################################################################\n########## 2015 ###########################################################################\nfit.UP30.korean.2015.engineer <- glm(Direction~second_korean, data = merge_2015_korean_UP30.engineer, family = binomial)\nsummary(fit.UP30.korean.2015.engineer)\nexp(0.11300) # 1.119632\n\nfit.UP30.korean.2015.social <- glm(Direction~second_korean, data = merge_2015_korean_UP30.social, family = binomial)\nsummary(fit.UP30.korean.2015.social)\nexp(0.08741) # 1.091344\n\nfit.UP30.korean.2015.art_psy <- glm(Direction~second_korean, data = merge_2015_korean_UP30.art_psy, family = binomial)\nsummary(fit.UP30.korean.2015.art_psy)\nexp(0.03370) # 1.034274\n\nfit.UP30.korean.2015.science <- glm(Direction~second_korean, data = merge_2015_korean_UP30.science, family = binomial)\nsummary(fit.UP30.korean.2015.science)\nexp(0.11366) # 1.120371\n\nfit.UP30.english.2015.engineer <- glm(Direction~second_english, data = merge_2015_english_UP30.engineer, family = binomial)\nsummary(fit.UP30.english.2015.engineer)\nexp(0.04254) # 1.043458\n\nfit.UP30.english.2015.social <- glm(Direction~second_english, data = merge_2015_english_UP30.social, family = binomial)\nsummary(fit.UP30.english.2015.social)\nexp(0.05615) # 1.057756\n\nfit.UP30.english.2015.art_psy <- glm(Direction~second_english, data = merge_2015_english_UP30.art_psy, family = binomial)\nsummary(fit.UP30.english.2015.art_psy)\nexp(0.04296) # 1.043896\n\nfit.UP30.english.2015.science <- glm(Direction~second_english, data = merge_2015_english_UP30.science, family = binomial)\nsummary(fit.UP30.english.2015.science)\nexp(-0.008937) # 0.9911028\n\nfit.UP30.math.2015.engineer <- glm(Direction~second_math, data = merge_2015_math_UP30.engineer, family = binomial)\nsummary(fit.UP30.math.2015.engineer)\nexp(0.09699) # 1.101849\n###########################################################################################\n#########################################################################################################\n##### Lower 30% (split Department) #######################################################################\nmerge_2014_korean_DOWN30.engineer<- merge_2014_korean.engineer[merge_2014_korean.engineer$second_korean <= quan_30_korean.2014.engineer[2],]\nmerge_2014_korean_DOWN30.social<- merge_2014_korean.social[merge_2014_korean.social$second_korean <= quan_30_korean.2014.social[2],]\nmerge_2014_korean_DOWN30.art_psy<- merge_2014_korean.art_psy[merge_2014_korean.art_psy$second_korean <= quan_30_korean.2014.art_psy[2],]\nmerge_2014_korean_DOWN30.science<- merge_2014_korean.science[merge_2014_korean.science$second_korean <= quan_30_korean.2014.science[2],]\n\nmerge_2015_korean_DOWN30.engineer<- merge_2015_korean.engineer[merge_2015_korean.engineer$second_korean <= quan_30_korean.2015.engineer[2],]\nmerge_2015_korean_DOWN30.social<- merge_2015_korean.social[merge_2015_korean.social$second_korean <= quan_30_korean.2015.social[2],]\nmerge_2015_korean_DOWN30.art_psy<- merge_2015_korean.art_psy[merge_2015_korean.art_psy$second_korean <= quan_30_korean.2015.art_psy[2],]\nmerge_2015_korean_DOWN30.science<- merge_2015_korean.science[merge_2015_korean.science$second_korean <= quan_30_korean.2015.science[2],]\n\nmerge_2014_english_DOWN30.engineer<- merge_2014_english.engineer[merge_2014_english.engineer$second_english <= quan_30_english.2014.engineer[2],]\nmerge_2014_english_DOWN30.social<- merge_2014_english.social[merge_2014_english.social$second_english <= quan_30_english.2014.social[2],]\nmerge_2014_english_DOWN30.art_psy<- merge_2014_english.art_psy[merge_2014_english.art_psy$second_english <= quan_30_english.2014.art_psy[2],]\nmerge_2014_english_DOWN30.science<- merge_2014_english.science[merge_2014_english.science$second_english <= quan_30_english.2014.science[2],]\n\nmerge_2015_english_DOWN30.engineer<- merge_2015_english.engineer[merge_2015_english.engineer$second_english <= quan_30_english.2015.engineer[2],]\nmerge_2015_english_DOWN30.social<- merge_2015_english.social[merge_2015_english.social$second_english <= quan_30_english.2015.social[2],]\nmerge_2015_english_DOWN30.art_psy<- merge_2015_english.art_psy[merge_2015_english.art_psy$second_english <= quan_30_english.2015.art_psy[2],]\nmerge_2015_english_DOWN30.science<- merge_2015_english.science[merge_2015_english.science$second_english <= quan_30_english.2015.science[2],]\n\nmerge_2014_math_DOWN30.engineer<- merge_2014_math.engineer[merge_2014_math.engineer$second_math <= quan_30_math.2014.engineer[2],]\n\nmerge_2015_math_DOWN30.engineer<- merge_2015_math.engineer[merge_2015_math.engineer$second_math <= quan_30_math.2015.engineer[2],]\n\n########## 2014 ###########################################################################\nfit.DOWN30.korean.2014.engineer <- glm(Direction~second_korean, data = merge_2014_korean_DOWN30.engineer, family = binomial)\nsummary(fit.DOWN30.korean.2014.engineer)\nexp(0.05260) # 1.054008\n\nfit.DOWN30.korean.2014.social <- glm(Direction~second_korean, data = merge_2014_korean_DOWN30.social, family = binomial)\nsummary(fit.DOWN30.korean.2014.social)\nexp(0.02804) # 1.028437\n\nfit.DOWN30.korean.2014.art_psy <- glm(Direction~second_korean, data = merge_2014_korean_DOWN30.art_psy, family = binomial)\nsummary(fit.DOWN30.korean.2014.art_psy)\nexp(-0.0002237) # 0.9997763\n\nfit.DOWN30.korean.2014.science <- glm(Direction~second_korean, data = merge_2014_korean_DOWN30.science, family = binomial)\nsummary(fit.DOWN30.korean.2014.science)\nexp(-0.01451) # 0.9855948\n\nfit.DOWN30.english.2014.engineer <- glm(Direction~second_english, data = merge_2014_english_DOWN30.engineer, family = binomial)\nsummary(fit.DOWN30.english.2014.engineer)\nexp(0.12247) # 1.130285\n\nfit.DOWN30.english.2014.social <- glm(Direction~second_english, data = merge_2014_english_DOWN30.social, family = binomial)\nsummary(fit.DOWN30.english.2014.social)\nexp(0.05267) # 1.054082\n\nfit.DOWN30.english.2014.art_psy <- glm(Direction~second_english, data = merge_2014_english_DOWN30.art_psy, family = binomial)\nsummary(fit.DOWN30.english.2014.art_psy)\nexp(0.01537) # 1.015489\n\nfit.DOWN30.english.2014.science <- glm(Direction~second_english, data = merge_2014_english_DOWN30.science, family = binomial)\nsummary(fit.DOWN30.english.2014.science)\nexp(0.08217) # 1.08564\n\nfit.DOWN30.math.2014.engineer <- glm(Direction~second_math, data = merge_2014_math_DOWN30.engineer, family = binomial)\nsummary(fit.DOWN30.math.2014.engineer)\nexp(0.09738) # 1.102279\n\n###########################################################################################\n########## 2015 ###########################################################################\nfit.DOWN30.korean.2015.engineer <- glm(Direction~second_korean, data = merge_2015_korean_DOWN30.engineer, family = binomial)\nsummary(fit.DOWN30.korean.2015.engineer)\nexp(0.04906) # 1.050283\n\nfit.DOWN30.korean.2015.social <- glm(Direction~second_korean, data = merge_2015_korean_DOWN30.social, family = binomial)\nsummary(fit.DOWN30.korean.2015.social)\nexp(0.05153) # 1.052881\n\nfit.DOWN30.korean.2015.art_psy <- glm(Direction~second_korean, data = merge_2015_korean_DOWN30.art_psy, family = binomial)\nsummary(fit.DOWN30.korean.2015.art_psy)\nexp(0.03817) # 1.038908\n\nfit.DOWN30.korean.2015.science <- glm(Direction~second_korean, data = merge_2015_korean_DOWN30.science, family = binomial)\nsummary(fit.DOWN30.korean.2015.science)\nexp(0.01757) # 1.017725\n\nfit.DOWN30.english.2015.engineer <- glm(Direction~second_english, data = merge_2015_english_DOWN30.engineer, family = binomial)\nsummary(fit.DOWN30.english.2015.engineer)\nexp(0.07063) # 1.073184\n\nfit.DOWN30.english.2015.social <- glm(Direction~second_english, data = merge_2015_english_DOWN30.social, family = binomial)\nsummary(fit.DOWN30.english.2015.social)\nexp(0.09652) # 1.101332\n\nfit.DOWN30.english.2015.art_psy <- glm(Direction~second_english, data = merge_2015_english_DOWN30.art_psy, family = binomial)\nsummary(fit.DOWN30.english.2015.art_psy)\nexp(0.07437) # 1.077205\n\nfit.DOWN30.english.2015.science <- glm(Direction~second_english, data = merge_2015_english_DOWN30.science, family = binomial)\nsummary(fit.DOWN30.english.2015.science)\nexp(0.06404) # 1.066135\n\nfit.DOWN30.math.2015.engineer <- glm(Direction~second_math, data = merge_2015_math_DOWN30.engineer, family = binomial)\nsummary(fit.DOWN30.math.2015.engineer)\nexp(0.04656) # 1.047661\n###########################################################################################\n#########################################################################################################\n##### Lower 40% (split Department) #######################################################################\nmerge_2014_korean_DOWN40.engineer<- merge_2014_korean.engineer[merge_2014_korean.engineer$second_korean <= quan_40_korean.2014.engineer[3],]\nmerge_2014_korean_DOWN40.social<- merge_2014_korean.social[merge_2014_korean.social$second_korean <= quan_40_korean.2014.social[3],]\nmerge_2014_korean_DOWN40.art_psy<- merge_2014_korean.art_psy[merge_2014_korean.art_psy$second_korean <= quan_40_korean.2014.art_psy[3],]\nmerge_2014_korean_DOWN40.science<- merge_2014_korean.science[merge_2014_korean.science$second_korean <= quan_40_korean.2014.science[3],]\n\nmerge_2015_korean_DOWN40.engineer<- merge_2015_korean.engineer[merge_2015_korean.engineer$second_korean <= quan_40_korean.2015.engineer[3],]\nmerge_2015_korean_DOWN40.social<- merge_2015_korean.social[merge_2015_korean.social$second_korean <= quan_40_korean.2015.social[3],]\nmerge_2015_korean_DOWN40.art_psy<- merge_2015_korean.art_psy[merge_2015_korean.art_psy$second_korean <= quan_40_korean.2015.art_psy[3],]\nmerge_2015_korean_DOWN40.science<- merge_2015_korean.science[merge_2015_korean.science$second_korean <= quan_40_korean.2015.science[3],]\n\nmerge_2014_english_DOWN40.engineer<- merge_2014_english.engineer[merge_2014_english.engineer$second_english <= quan_40_english.2014.engineer[3],]\nmerge_2014_english_DOWN40.social<- merge_2014_english.social[merge_2014_english.social$second_english <= quan_40_english.2014.social[3],]\nmerge_2014_english_DOWN40.art_psy<- merge_2014_english.art_psy[merge_2014_english.art_psy$second_english <= quan_40_english.2014.art_psy[3],]\nmerge_2014_english_DOWN40.science<- merge_2014_english.science[merge_2014_english.science$second_english <= quan_40_english.2014.science[3],]\n\nmerge_2015_english_DOWN40.engineer<- merge_2015_english.engineer[merge_2015_english.engineer$second_english <= quan_40_english.2015.engineer[3],]\nmerge_2015_english_DOWN40.social<- merge_2015_english.social[merge_2015_english.social$second_english <= quan_40_english.2015.social[3],]\nmerge_2015_english_DOWN40.art_psy<- merge_2015_english.art_psy[merge_2015_english.art_psy$second_english <= quan_40_english.2015.art_psy[3],]\nmerge_2015_english_DOWN40.science<- merge_2015_english.science[merge_2015_english.science$second_english <= quan_40_english.2015.science[3],]\n\nmerge_2014_math_DOWN40.engineer<- merge_2014_math.engineer[merge_2014_math.engineer$second_math <= quan_40_math.2014.engineer[3],]\n\nmerge_2015_math_DOWN40.engineer<- merge_2015_math.engineer[merge_2015_math.engineer$second_math <= quan_40_math.2015.engineer[3],]\n\n########## 2014 ###########################################################################\nfit.DOWN40.korean.2014.engineer <- glm(Direction~second_korean, data = merge_2014_korean_DOWN40.engineer, family = binomial)\nsummary(fit.DOWN40.korean.2014.engineer)\nexp(0.03658) # 1.037257\n\nfit.DOWN40.korean.2014.social <- glm(Direction~second_korean, data = merge_2014_korean_DOWN40.social, family = binomial)\nsummary(fit.DOWN40.korean.2014.social)\nexp(0.01559) # 1.015712\n\nfit.DOWN40.korean.2014.art_psy <- glm(Direction~second_korean, data = merge_2014_korean_DOWN40.art_psy, family = binomial)\nsummary(fit.DOWN40.korean.2014.art_psy)\nexp(-0.0002237) # 0.9997763\n\nfit.DOWN40.korean.2014.science <- glm(Direction~second_korean, data = merge_2014_korean_DOWN40.science, family = binomial)\nsummary(fit.DOWN40.korean.2014.science)\nexp(0.04169) # 1.042571\n\nfit.DOWN40.english.2014.engineer <- glm(Direction~second_english, data = merge_2014_english_DOWN40.engineer, family = binomial)\nsummary(fit.DOWN40.english.2014.engineer)\nexp(0.09276) # 1.097198\n\nfit.DOWN40.english.2014.social <- glm(Direction~second_english, data = merge_2014_english_DOWN40.social, family = binomial)\nsummary(fit.DOWN40.english.2014.social)\nexp(0.06785) # 1.070205\n\nfit.DOWN40.english.2014.art_psy <- glm(Direction~second_english, data = merge_2014_english_DOWN40.art_psy, family = binomial)\nsummary(fit.DOWN40.english.2014.art_psy)\nexp(0.001263) # 1.001264\n\nfit.DOWN40.english.2014.science <- glm(Direction~second_english, data = merge_2014_english_DOWN40.science, family = binomial)\nsummary(fit.DOWN40.english.2014.science)\nexp(0.04295) # 1.043886\n\nfit.DOWN40.math.2014.engineer <- glm(Direction~second_math, data = merge_2014_math_DOWN40.engineer, family = binomial)\nsummary(fit.DOWN40.math.2014.engineer)\nexp(0.07578) # 1.078725\n\n###########################################################################################\n########## 2015 ###########################################################################\nfit.DOWN40.korean.2015.engineer <- glm(Direction~second_korean, data = merge_2015_korean_DOWN40.engineer, family = binomial)\nsummary(fit.DOWN40.korean.2015.engineer)\nexp(0.039573) # 1.040366\n\nfit.DOWN40.korean.2015.social <- glm(Direction~second_korean, data = merge_2015_korean_DOWN40.social, family = binomial)\nsummary(fit.DOWN40.korean.2015.social)\nexp(0.04022) # 1.04104\n\nfit.DOWN40.korean.2015.art_psy <- glm(Direction~second_korean, data = merge_2015_korean_DOWN40.art_psy, family = binomial)\nsummary(fit.DOWN40.korean.2015.art_psy)\nexp(0.04436) # 1.045359\n\nfit.DOWN40.korean.2015.science <- glm(Direction~second_korean, data = merge_2015_korean_DOWN40.science, family = binomial)\nsummary(fit.DOWN40.korean.2015.science)\nexp(0.04549) # 1.046541\n\nfit.DOWN40.english.2015.engineer <- glm(Direction~second_english, data = merge_2015_english_DOWN40.engineer, family = binomial)\nsummary(fit.DOWN40.english.2015.engineer)\nexp(0.050159) # 1.051438\n\nfit.DOWN40.english.2015.social <- glm(Direction~second_english, data = merge_2015_english_DOWN40.social, family = binomial)\nsummary(fit.DOWN40.english.2015.social)\nexp(0.06907) # 1.071511\n\nfit.DOWN40.english.2015.art_psy <- glm(Direction~second_english, data = merge_2015_english_DOWN40.art_psy, family = binomial)\nsummary(fit.DOWN40.english.2015.art_psy)\nexp(0.05114) # 1.05247\n\nfit.DOWN40.english.2015.science <- glm(Direction~second_english, data = merge_2015_english_DOWN40.science, family = binomial)\nsummary(fit.DOWN40.english.2015.science)\nexp(0.04935) # 1.050588\n\nfit.DOWN40.math.2015.engineer <- glm(Direction~second_math, data = merge_2015_math_DOWN40.engineer, family = binomial)\nsummary(fit.DOWN40.math.2015.engineer)\nexp(0.029620) # 1.030063\n###########################################################################################\n#########################################################################################################\n#########################################################################################################################################\n\n### Add Data Analytic(Re Education)##################################################################\nre_edu <- loadWorkbook(\"2015_re.xlsx\")\nre_edu_korean <- readWorksheet(re_edu, 1)\nre_edu_english <- readWorksheet(re_edu, 2)\nre_edu_math <- readWorksheet(re_edu, 3)\n\nedu_2015_re.korean <- subset(merge_2015_korean, 성명 %in% re_edu_korean$성명)\nedu_2015_re.english <- subset(merge_2015_english, 성명 %in% re_edu_english$성명)\nedu_2015_re.math <- subset(merge_2015_math, 성명 %in% re_edu_math$성명)\n\n## re education list \nnrow(edu_2015_re.korean) ## 국어 55명\nnrow(edu_2015_re.english) ## 영어 75명\nnrow(edu_2015_re.math) ## 2 명\n\nfit.re.korean <- glm(Direction~second_korean, data = edu_2015_re.korean, family = binomial)\nsummary(fit.re.korean)\nexp(0.05252) ## 1.053924\nfit.re.english <- glm(Direction~second_english, data = edu_2015_re.english, family = binomial)\nsummary(fit.re.english)\nexp(0.05046) ## 1.051755\nfit.re.math <- glm(Direction~second_math, data = edu_2015_re.math, family = binomial)\nsummary(fit.re.math)\nexp(1.218e-15) ## 1 (because very small data : 2)\n\n\n#### Error Rate ##########################################################\n########### 2015 ###############################\ntable(edu_2015_re.korean$Direction) ## DOWN : 37 , UP : 18\nre.err.2015.korean <- getCutOff(edu_2015_re.korean, fit.re.korean) # cutoff : 0.3872484\nxtabs(~edu_2015_re.korean$Direction+(fit.re.korean$fitted.values> re.err.2015.korean))\n# merge_2015_korean$Direction FALSE TRUE\n#                        DOWN    30    7\n#                        UP       8   10\n## Sensitivity = 10 / (10+8) : 0.556\n## Specificity = 30 / (30+7) : 0.811\n## Error Rate = (7+8) / (37+18) : 0.273\ntable(edu_2015_re.english$Direction) ## DOWN : 46 , UP : 29\nre.err.2015.english <- getCutOff(edu_2015_re.english, fit.re.english) # 0.5578644\nxtabs(~edu_2015_re.english$Direction+(fit.re.english$fitted.values > re.err.2015.english))\n# edu_2015_re.english$Direction FALSE TRUE\n#                         DOWN    39    7\n#                         UP      16   13 \n## Sensitivity = 13 / (16+13) : 0.118\n## Specificity = 39 / (39+7) : 0.848\n## Error Rate = (7+16) / (46+29) : 0.307\n################################################\n##########################################################################\n#####################################################################################################",
    "created" : 1455174288679.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3675735018",
    "id" : "4E3738E2",
    "lastKnownWriteTime" : 1455501156,
    "path" : "C:/RCodeRepositories/Bucheon_subject2/subject2.R",
    "project_path" : "subject2.R",
    "properties" : {
        "notebook_format" : "word_document",
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_source"
}