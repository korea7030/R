{
    "contents" : "## excel package사용\ninstall.packages(\"XLConnect\")\nlibrary(XLConnect)\n\nxls = loadWorkbook(\"./sample/청소년통계.xls\", create=TRUE)\nstr(xls)\n\nteenager2 <- readWorksheet(xls,sheet=\"고민문제\")\nteenager3 <- readWorksheet(xls,sheet=\"음주흡연율\")\nteenager4 <- readWorksheet(xls,sheet=\"학교생활만족도\")\nteenager5 <- readWorksheet(xls,sheet=\"학교폭력\")\nteenager6 <- readWorksheet(xls,sheet=\"직업선택요인\")\nteenager7 <- readWorksheet(xls,sheet=\"선호하는직장\")\n\nstr(teenager7)\n\n## 그래프 배치 위한 방법\npar(mfrow=c(3,2))\n\n## 그래프 그리기(주요 고민거리) \nbp2 <- barplot(as.matrix(teenager2), main=\"주요 고민거리\", beside=T, axes=F, ylab=\"비율(%)\", xlab=\"항목\", cex.names=1.0, ylim=c(0,40), col=c(\"skyblue\", \"plum\"), border=\"white\", las=2, names.arg=c(\"외모\",\"가정환경\",\"용돈\",\"성적\",\"직업\",\"친구\",\"이성교제\",\"흡연\",\"기타\",\"고민없음\"))\n## y축 범위 지정\naxis(2, ylim=seq(0,40,10), las=1)\n## 가로점선\nabline(h=seq(0,40,5), lty=2)\n## 퍼센트 표시 위한 \npct <- as.matrix(teenager2)\ntext(x=bp2, y=as.matrix(teenager2)*1.05, labels=paste(pct,\"%\"), col=\"navy\", cex=0.7)\n\n## 범례\nlegend(\"topright\", c(\"남자\",\"여자\"), cex=0.9, fill=c(\"skyblue\",\"plum\"), bg=\"white\")\n\n\n## 흡연율/음주율 그래프 \nbp3 <- barplot(as.matrix(teenager3), main=\"흡연율/음주율\", beside=T, axes=F, ylab=\"비율(%)\", xlab=\"연도(년)\", cex.names=1.2, ylim=c(0,40), col=c(\"gray\", \"tan\"), border=\"white\", las=2, names.arg=c(\"2009\",\"2010\",\"2011\",\"2012\",\"2013\"))\n\naxis(2, ylim=c(0,10,20,30,40), las=1)\n## 퍼센트 글자 표시\npct <- as.matrix(teenager3)\ntext(x=bp3, y=as.matrix(teenager3) * 1.05, labels=paste(pct,\"%\"), col=\"navy\", cex=0.7)\n## 범례 표시\nlegend(\"topright\", c(\"흡연\",\"음주\"), cex=0.9, fill=c(\"gray\", \"tan\"), bg=\"white\")\n\n## 학교생활 만족도 그래프  \nbp4 <- barplot(as.matrix(teenager4), main=\"학교 생활 만족도\", beside=T, axes=F, ylab=\"비율(%)\", xlab=\"만족도\", cex.names=1.2, ylim=c(0,40), col=c(\"gray\", \"tan\"), border=\"white\", las=2, names.arg=c(\"매우만족\",\"만족\",\"보통\",\"불만족\",\"매우불만족\"))\n\naxis(2, ylim=c(0,10,20,30,40,50,60), las=1)\n## 퍼센트 글자 표시\nabline(h=seq(0,60,5), lty=2)\npct <- as.matrix(teenager4)\ntext(x=bp3, y=as.matrix(teenager4) * 1.05, labels=paste(pct,\"%\"), col=\"navy\", cex=0.7)\n## 범례 표시\nlegend(\"topright\", c(\"중학생\",\"고등학생\"), cex=0.9, fill=c(\"limegreen\", \"gold\"), bg=\"white\")\n\n\n\n## 학교폭력사유   \nbp5 <- barplot(as.matrix(teenager5), main=\"학교 폭력 사유\", beside=T, axes=F, ylab=\"비율(%)\", xlab=\"피해사유\", cex.names=1.2, ylim=c(0,40), col=c(\"skyblue\", \"plum\",\"limegreen\", \"gold\"), border=\"white\", las=2, names.arg=c(\"피해경험\",\"이유없다\",\"약해서\",\"잘못해서\",\"외모/장애\",\"성격\",\"금품요구불응\",\"기타\"))\n\naxis(2, ylim=c(0,10,20,30,40,50,60), las=1)\n## 퍼센트 글자 표시\nabline(h=seq(0,60,5), lty=2)\npct <- as.matrix(teenager5)\ntext(x=bp5, y=as.matrix(teenager5) * 1.05, labels=paste(pct,\"%\"), col=\"navy\", cex=0.7)\n## 범례 표시\nlegend(\"topright\", c(\"남자\",\"여자\",\"중학생\",\"고등학생\"), cex=0.9, fill=c(\"skyblue\",\"plum\",\"limegreen\", \"gold\"), bg=\"white\")\n\n## 직업선택 요인 그래프\nbp6 <- barplot(as.matrix(teenager6), main=\"직업 선택 요인\", beside=T, axes=F, ylab=\"비율(%)\", xlab=\"항목\", cex.names=1.2, ylim=c(0,50), col=c(\"skyblue\", \"plum\",\"limegreen\", \"gold\"), border=\"white\", las=2, names.arg=c(\"명예/명성\",\"안정성\",\"수입\",\"적성/흥미\",\"보람/자아성취\",\"발전가능성\",\"기타\"))\n\naxis(2, ylim=c(0,10,20,30,40,50), las=1)\n## 퍼센트 글자 표시\nabline(h=seq(0,50,5), lty=2)\npct <- as.matrix(teenager6)\ntext(x=bp6, y=as.matrix(teenager6) * 1.05, labels=paste(pct,\"%\"), col=\"navy\", cex=0.7)\n## 범례 표시\nlegend(\"topright\", c(\"남자\",\"여자\",\"중학생\",\"고등학생\",\"대학생\"), cex=0.9, fill=c(\"skyblue\",\"plum\",\"limegreen\", \"gold\",\"blue\"), bg=\"white\")\n\n## 직장 선호도 그래프 그리기 \nbp7 <- barplot(as.matrix(teenager7), main=\"직장 선호도\", beside=T, axes=F, ylab=\"비율(%)\", xlab=\"기업 종류\", cex.names=1.2, ylim=c(0,40), col=c(\"skyblue\", \"plum\",\"limegreen\", \"gold\",\"blue\"), border=\"white\", las=2, names.arg=c(\"국가기관\",\"공기업\",\"대기업\",\"벤쳐\",\"외국계\",\"전문직\",\"중소기업\",\"해외\",\"자영업\",\"기타\"))\n\naxis(2, ylim=c(0,10,20,30,40), las=1)\n## 퍼센트 글자 표시\nabline(h=seq(0,40,5), lty=2)\npct <- as.matrix(teenager7)\ntext(x=bp7, y=as.matrix(teenager7) * 1.05, labels=paste(pct,\"%\"), col=\"navy\", cex=0.7)\n## 범례 표시\nlegend(\"topright\", c(\"남자\",\"여자\",\"중학생\",\"고등학생\",\"대학생\"), cex=0.9, fill=c(\"skyblue\",\"plum\",\"limegreen\", \"gold\",\"blue\"), bg=\"white\")\n",
    "created" : 1437199620516.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1957577396",
    "id" : "2FB5650",
    "lastKnownWriteTime" : 1437199843,
    "path" : "C:/RCodeRepositories/Rlov/fixedData/consider_script.R",
    "project_path" : "consider_script.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "type" : "r_source"
}