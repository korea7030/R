{
    "contents" : "app <- read.table(file=\"Applicant.TXT\", header=T)\n\napp <- app[,-1]\nstr(app)\n\n## 15개의 변수 회사의 job position에 대해 지원자 48명의 명단\n## 해당 position에 대한 business 능력을 평가\n## 각각의 능력 점수는 10점 만점으로 평가\n\n\n# $ X1.FL.   : int  6 9 7 5 6 7 9 9 9 4 ...\n# $ X2.APP.  : int  7 10 8 6 8 7 9 9 9 7 ...\n# $ X3.AA.   : int  2 5 3 8 8 7 8 9 7 10 ...\n# $ X4.LA.   : int  5 8 6 5 8 6 8 8 8 2 ...\n# $ X5.SC.   : int  8 10 9 6 4 8 8 9 8 10 ...\n# $ X6.LC.   : int  7 9 8 5 4 7 8 9 8 10 ...\n# $ X7.HON.  : int  8 9 9 9 9 10 8 8 8 7 ...\n# $ X8.SMS.  : int  8 10 7 2 5 5 8 8 5 10 ...\n# $ X9.EXP.  : int  3 5 4 8 8 9 10 10 9 3 ...\n# $ X10.DRV. : int  8 9 9 4 5 6 8 9 8 10 ...\n# $ X11.AMB. : int  9 9 9 5 5 5 10 10 9 10 ...\n# $ X12.GSP. : int  7 8 8 8 8 8 8 9 8 10 ...\n# $ X13.POT. : int  5 8 6 7 8 6 9 9 8 9 ...\n# $ X14.KJ.  : int  7 8 8 6 7 6 8 9 8 3 ...\n# $ X15.SUIT.: int  10 10 10 5 7 6 10 10 10 10 ...\n\n## 어떤 잠재 요인이 15개의 변수에 대해 얼마나 영향을 주는지 파악\n\n## factor의 개수를 4개로 했을 때\nfal <- factanal(app, 4)\n\nfal\n\n\n\n# Call:\n#   factanal(x = app, factors = 4)\n# \n## Uniquenesses: 특정인자의 분산값(ui값) \n## 값이 커질수록 factor에 대해 설명이 가능하지 않음.\n## 1- 각각의 분산값 = 설명가능 % 로 생각\n## ex) X2.APP = 1- 0.685 = 0.315(31.5%) 만큼 설명이 가능하다.\n\n# X1.FL.   X2.APP.    X3.AA.    X4.LA.    X5.SC.    X6.LC.   X7.HON.   X8.SMS.   X9.EXP.  X10.DRV. \n# 0.443     0.685     0.521     0.185     0.119     0.198     0.339     0.138     0.357     0.226 \n# X11.AMB.  X12.GSP.  X13.POT.   X14.KJ. X15.SUIT. \n# 0.137     0.153     0.090     0.005     0.252 \n# \n## 인자적재값(factor loading)\n## 빈공간이 있는 경우는 0의 값이라고 생각\n## -의 의미는 factor가 음의 영향을 준다는 의미\n# Loadings:\n#             l11      l12    l13     l14\n#           Factor1 Factor2 Factor3 Factor4\n# X1.FL.     0.129   0.717   0.113  -0.117 \n# X2.APP.    0.458   0.142   0.243   0.164 \n# X3.AA.             0.126           0.677 \n# X4.LA.     0.231   0.239   0.838         \n# X5.SC.     0.918           0.142         \n# X6.LC.     0.838   0.111   0.291         \n# X7.HON.    0.252  -0.216   0.742         \n# X8.SMS.    0.885   0.258                 \n# X9.EXP.            0.778           0.165 \n# X10.DRV.   0.767   0.389   0.172         \n# X11.AMB.   0.904   0.181                 \n# X12.GSP.   0.792   0.275   0.351   0.148 \n# X13.POT.   0.735   0.349   0.432   0.247 \n# X14.KJ.    0.424   0.389   0.554  -0.598 \n# X15.SUIT.  0.364   0.770           0.142 \n# \n#                 Factor1 Factor2 Factor3 Factor4\n# SS loadings      5.570   2.473   2.099   1.013\n# Proportion Var   0.371   0.165   0.140   0.068\n# Cumulative Var   0.371   0.536   0.676   0.744\n# \n# Test of the hypothesis that 4 factors are sufficient.\n# The chi square statistic is 84 on 51 degrees of freedom.\n# The p-value is 0.00247 \n\n\nprint(fal, digits=2, sort=T)\n\n# Call:\n#   factanal(x = app, factors = 4)\n# \n# Uniquenesses: \n# X1.FL.   X2.APP.    X3.AA.    X4.LA.    X5.SC.    X6.LC.   X7.HON.   X8.SMS.   X9.EXP.  X10.DRV. \n# 0.44      0.68      0.52      0.18      0.12      0.20      0.34      0.14      0.36      0.23 \n# X11.AMB.  X12.GSP.  X13.POT.   X14.KJ. X15.SUIT. \n# 0.14      0.15      0.09      0.00      0.25 \n# \n## 인자적재값 행렬\n## 공통성 : SC = 0.92*0.92 + 0.14*0.14 \n##        : LC = 0.84*0.84 + 0.29*0.29 = 0.802 이면 나머지 20%는 위의 uniqunesses 값을 의미\n## factor1에 의해 설명가능한 변수 : SC, Lc, SM, DR, AM, GC, PO\n## factor1과 SC의 상관계수가 0.92를 나타낸다.즉 factor1과 sc는 연관이 많이 되는 변수\n# Loadings:\n\n## 각각의 변수에 대해 factor1~4 가 얼마만큼 설명가능한지 \n#          Factor1 Factor2 Factor3 Factor4\n# X5.SC.     0.92            0.14          \n# X6.LC.     0.84    0.11    0.29          \n# X8.SMS.    0.88    0.26                  \n# X10.DRV.   0.77    0.39    0.17          \n# X11.AMB.   0.90    0.18                  \n# X12.GSP.   0.79    0.28    0.35    0.15  \n# X13.POT.   0.74    0.35    0.43    0.25  \n# X1.FL.     0.13    0.72    0.11   -0.12  \n# X9.EXP.            0.78            0.17  \n# X15.SUIT.  0.36    0.77            0.14  \n# X4.LA.     0.23    0.24    0.84          \n# X7.HON.    0.25   -0.22    0.74          \n# X3.AA.             0.13            0.68  \n# X14.KJ.    0.42    0.39    0.55   -0.60  \n# X2.APP.    0.46    0.14    0.24    0.16  \n# \n#                 Factor1 Factor2 Factor3 Factor4\n# SS loadings       5.57    2.47    2.10    1.01\n# Proportion Var    0.37    0.16    0.14    0.07  (factor각각이 전체 분산의 몇% 만큼 설명이 가능한가)\n# Cumulative Var    0.37    0.54    0.68    0.74\n# \n# Test of the hypothesis that 4 factors are sufficient.\n# The chi square statistic is 84 on 51 degrees of freedom.\n# The p-value is 0.00247  ## 귀무가설 기각\n\n## 귀무가설 : 4개의 factor가 충분하다. \n## 대립가설 : 4개의 factor가 충분하지 않다.\n\n## factor1과 factor2의 값들을 plot\n## 각 점은 원래 변수들을 의미\nload <- fal$loadings\nload\n\n## 새창 띄움\nwindows()\n## type = 'n' : 아무것도 안찍힘\nplot(load, type='n')\ntext(load, labels=names(app), cex=0.7)\n## 각 factor에 대해서 어떤 원변수가 설명을 잘해주는지 판단이 가능.\n\n################### HW1 ###########################\n\nstock_price <- read.csv(\"stock_price.csv\", header=T)\n\nhead(stock_price)\n\nstr(stock_price)\n\nstock_price <- stock_price[,-1]\n\nstr(stock_price)\n# data.frame':\t103 obs. of  6 variables:\n## 주별 주가 정보\n# $ Week           : int  1 2 3 4 5 6 7 8 9 10 ...\n# $ JPMorgan       : num  0.01303 0.00849 -0.01792 0.02156 0.01082 ...   (금융기관)\n# $ Citibank       : num  -0.00784 0.01669 -0.00864 -0.00349 0.00372 ... (금융기관)\n# $ WellsFargo     : num  -0.00319 -0.00621 0.01004 0.01744 -0.01013 ... (금융기관)\n# $ RoyalDutchShell: num  -0.0448 0.012 0 -0.0286 0.0292 ...             \n# $ ExxonMobil     : num  0.00522 0.01349 -0.00614 -0.00695 0.04098 ...\n\nstock_fal <- factanal(stock_price, factors = 2)\n\nstock_fal_none <- factanal(stock_price, factors = 2, rotation = \"none\")\n\nstock_fal\n\nstock_fal_none\n\n# \n# Call:\n#   factanal(x = stock_price, factors = 2)\n# \n# Uniquenesses:\n#   JPMorgan        Citibank      WellsFargo RoyalDutchShell      ExxonMobil \n# 0.417           0.275           0.542           0.005           0.530 \n# \n# Loadings:\n#                Factor1 Factor2\n# JPMorgan        0.763          \n# Citibank        0.819   0.232  \n# WellsFargo      0.668   0.108  \n# RoyalDutchShell 0.113   0.991  \n# ExxonMobil      0.108   0.677  \n# \n#                 Factor1 Factor2\n# SS loadings      1.725   1.507\n# Proportion Var   0.345   0.301\n# Cumulative Var   0.345   0.646\n# \n# Test of the hypothesis that 2 factors are sufficient.\n# The chi square statistic is 1.97 on 1 degree of freedom.\n# The p-value is 0.16 \n\nstock_load <- stock_fal$loadings\nplot(stock_load, type=\"n\")\ntext(stock_load, labels=names(stock_price), cex=0.7)\n\nstock_none_load <- stock_fal_none$loadings\nplot(stock_none_load, type=\"n\")\ntext(stock_none_load, labes=names(stock_price), cex=0.7)\n#######################################################################################\n\n##### 에러남....\nlibrary(psych)\ninstall.packages(\"GPArotation\")\nlibrary(GPArotation)\n\nfa3 <- fa(app, 4, rotation=\"quartimax\")\n\nplot(load[,1], load[,3], type=\"n\")\ntext(fa3, load[,1], load[,3], cex=0.7)\n\n#########################\n\n##인자점수 추정 \n\nfal4 <- factanal(app, 4, scores=\"regression\")\n\nfal4\n\nmarketing <- fal4$scores[,1]\nmarketing2 <- apply(app[,c(5,6,7,8,10:13)],1, sum)\n\n\n",
    "created" : 1445661670405.000,
    "dirty" : true,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "949416898",
    "id" : "B29DBC03",
    "lastKnownWriteTime" : 1445673844,
    "path" : "C:/MultivariateStatis/week7/week7.R",
    "project_path" : "week7.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_source"
}