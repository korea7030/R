{
    "contents" : "library(MVA)\n\ndata <- read.csv(file = 'open_closed.csv', header = T)\n\nhead(data)\n\n## 수학공학 과목 관련 시험점수\nstr(data)\n##########################################################\n## 'data.frame':\t88 obs. of  5 variables:\n##  $ mechanics_C : int  77 63 75 55 63 53 51 59 62 64 ...\n## $ vectors_C   : int  82 78 73 72 63 61 67 70 60 72 ...\n## $ algebra_O   : int  67 80 71 63 65 72 65 68 58 60 ...\n## $ analysis_O  : int  67 70 66 70 70 64 65 62 62 62 ...\n## $ statistics_O: int  81 81 81 68 63 73 68 56 70 45 ...\n#########################################################\n\ncor(data)  ## 상관계수\n## 각변수별로 1에 가깝냐에 따라 그래프가 선형에 가까움을 나타냄\n\n####################################################################\n##mechanics_C vectors_C algebra_O analysis_O statistics_O\n##mechanics_C    1.0000000 0.5534052 0.5467511  0.4093920    0.3890993\n##vectors_C      0.5534052 1.0000000 0.6096447  0.4850813    0.4364487\n##algebra_O      0.5467511 0.6096447 1.0000000  0.7108059    0.6647357\n##analysis_O     0.4093920 0.4850813 0.7108059  1.0000000    0.6071743\n##statistics_O   0.3890993 0.4364487 0.6647357  0.6071743    1.0000000\n######################################################################\n\npairs(data)\n\npca=prcomp(data)\n## scale = T\npca\n\n\n## Standard deviations: PC별로 만들어진 새로운 주성분의 표준편차를 의미. 이 값의 제곱이 고유값\n##   [1] PC1의 표준편차 : 26.210490 PC2의 표준편차 : 14.216577 PC3의 표준편차 : 10.185642  \n##       PC4의 표준편차 : 9.199481 PC5의 표준편차 :  5.670387\n\n## Rotation:  PC1 ~ PC5 각각의 값들이 가중치값(고유벡터)을 의미\n##   PC1         PC2        PC3          PC4         PC5\n## mechanics_C  -0.5054457 -0.74874751  0.2997888 -0.296184264 -0.07939388\n## vectors_C    -0.3683486 -0.20740314 -0.4155900  0.782888173 -0.18887639\n## algebra_O    -0.3456612  0.07590813 -0.1453182  0.003236339  0.92392015\n## analysis_O   -0.4511226  0.30088849 -0.5966265 -0.518139724 -0.28552169\n## statistics_O -0.5346501  0.54778205  0.6002758  0.175732020 -0.15123239\n\nsummary(pca)\n\n##\n## Importance of components:\n##                                            PC1     PC2     PC3     PC4     PC5\n## Standard deviation(각Pc별분산)           26.2105 14.2166 10.1856 9.19948 5.67039\n## Proportion of Variance(총분산비율)       0.6191  0.1821  0.0935 0.07627 0.02898\n## Cumulative Proportion(분산의 누적비율)   0.6191  0.8013  0.8948 0.97102 1.00000\n\n## 5개의 변수 중 하나의 주성분으로 축약 시 61.91% 로 설명이 가능하며 \n## 2개의 주성분으로 축약 시 80% 정보 설명이 가능하다.\n## 통상 70%~90% 이면 왠만한 설명이 가능하다고 봄.\n\npca2=prcomp(data, scale=T)\npca\n\n## -의 의미는 주성분을 나타내는 면에서는 절대값으로 보지만, \n##  각각의 변수에 대해선 (+), (-) 의 의미가 중요\n## meth, vector, algebra, analysis, statis 의 변수를 통해 PC1~PC5 까지의 새로운 변수를 생성\n\n# Standard deviations: 새로운 변수에 대한 편차 \n#   [1] 26.210490 14.216577 10.185642  9.199481  5.670387\n# \n# Rotation:\n#   PC1         PC2        PC3          PC4         PC5\n# mechanics_C  -0.5054457 -0.74874751  0.2997888 -0.296184264 -0.07939388\n# vectors_C    -0.3683486 -0.20740314 -0.4155900  0.782888173 -0.18887639\n# algebra_O    -0.3456612  0.07590813 -0.1453182  0.003236339  0.92392015\n# analysis_O   -0.4511226  0.30088849 -0.5966265 -0.518139724 -0.28552169\n# statistics_O -0.5346501  0.54778205  0.6002758  0.175732020 -0.15123239\n\npca2 ## scale=T 인 경우\n\n# Standard deviations: 표준편차가 1이 되도록 만들어준 뒤 구한 값\n#   [1] 1.7835302 0.8599836 0.6670571 0.6228101 0.4965788\n# \n# Rotation:\n#   PC1        PC2         PC3        PC4        PC5\n# mechanics_C  -0.3996045 -0.6454583  0.62078249 -0.1457865 -0.1306722\n# vectors_C    -0.4314191 -0.4415053 -0.70500628  0.2981351 -0.1817479\n# algebra_O    -0.5032816  0.1290675 -0.03704901 -0.1085987  0.8466894\n# analysis_O   -0.4569938  0.3879057 -0.13618182 -0.6662561 -0.4221885\n# statistics_O -0.4382444  0.4704545  0.31253342  0.6589164 -0.2340223\n\nplot(pca)\n\n## 꺾이는 부분이 심한부분을 찾게 되면 그 부분까지로 주성분 분석을 하면 됨.\nplot(pca,type='l')\nplot(pca2,type='l')\n\n\n############ HW2 ############################################################\nbulls <- read.csv(file='bulls.csv', header=T)\n\nhead(bulls)\n\nstr(bulls)\nsummary(bulls)\n## 소 종을 factor로 변경\nbulls$Breed = factor(bulls$Breed)\n# $ Breed   : int  1 1 1 1 1 1 1 1 1 1 ...\n# $ SalePr  : int  2200 2250 1625 4600 2150 1225 2250 4000 1600 1525 ...\n# $ YrHgt   : num  51 51.9 49.9 53.1 51.2 49.2 51 51.5 50.1 49.6 ...\n# $ FtFrBody: int  1128 1108 1011 993 996 985 959 1060 979 1083 ...\n# $ PrctFFB : num  70.9 72.1 71.6 68.9 68.6 71.4 72.1 69.3 71.2 75.8 ...\n# $ Frame   : int  7 7 6 8 7 6 7 7 6 6 ...\n# $ BkFat   : num  0.25 0.25 0.15 0.35 0.25 0.15 0.2 0.3 0.25 0.3 ...\n# $ SaleHt  : num  54.8 55.3 53.1 56.4 55 51.4 54 55.6 51.5 54.6 ...\n# $ SaleWt  : int  1720 1575 1410 1595 1488 1500 1522 1765 1365 1640 ...\n\n# bulls_excep <- bulls[,-c(1,2)] ## 문제에서 Breed, SalePr 을 빼라 햇음\n\nhead(bulls)\n\n## 공분산(cov)\ncov(bulls[,-c(1,2)])\n#             YrHgt    FtFrBody     PrctFFB       Frame        BkFat       SaleHt       SaleWt\n# YrHgt      2.99802632  100.130526   2.9600175  1.50884211 -0.053392105   2.98313684    82.810772\n# FtFrBody 100.13052632 8594.343860 209.5043509 51.95017544 -1.398175439 129.94007018  6680.308772\n# PrctFFB    2.96001754  209.504351  10.6916561  1.45922807 -0.142994737   3.41422456    83.925404\n# Frame      1.50884211   51.950175   1.4592281  0.85894737 -0.021614035   1.48757895    44.320702\n# BkFat     -0.05339211   -1.398175  -0.1429947 -0.02161404  0.008022368  -0.05064561     2.412965\n# SaleHt     2.98313684  129.940070   3.4142246  1.48757895 -0.050645614   4.01796491   147.289614\n# SaleWt    82.81077193 6680.308772  83.9254035 44.32070175  2.412964912 147.28961404 16850.661754\n\n## 상관계수(cor)\ncor(bulls[,-c(1,2)])\n#           YrHgt   FtFrBody    PrctFFB      Frame      BkFat     SaleHt    SaleWt\n# YrHgt     1.0000000  0.6237958  0.5228223  0.9402488 -0.3442770  0.8595129 0.3684348\n# FtFrBody  0.6237958  1.0000000  0.6911371  0.6046407 -0.1683852  0.6992519 0.5551134\n# PrctFFB   0.5228223  0.6911371  1.0000000  0.4815234 -0.4882545  0.5209146 0.1977254\n# Frame     0.9402488  0.6046407  0.4815234  1.0000000 -0.2603762  0.8007440 0.3683960\n# BkFat    -0.3442770 -0.1683852 -0.4882545 -0.2603762  1.0000000 -0.2820899 0.2075349\n# SaleHt    0.8595129  0.6992519  0.5209146  0.8007440 -0.2820899  1.0000000 0.5660575\n# SaleWt    0.3684348  0.5551134  0.1977254  0.3683960  0.2075349  0.5660575 1.0000000\n\n## 1번, 3번\npca_bulls_excep <- prcomp(bulls[,-c(1,2)])\n\n# Standard deviations:  이 값들의 제곱이 고유값\n#   [1] 143.45596038  69.81887125   2.33005787   1.82107340   0.68471173   0.27212808   0.06722679\n# \n# Rotation:  요값들이 가중치값이자 고유벡터\n#   주성분분석에 활용하고자 할때 \n#   PC1 = -5.887328e-03YrHgt + -4.870470e-01FtFrBody + ... 이 결과로 나온 PC1으로 분석\n#               PC1           PC2          PC3          PC4           PC5           PC6\n# YrHgt    -5.887328e-03 -0.0096800709 -0.286337289 -0.608787152 -0.5355689528 -0.5097273178\n# FtFrBody -4.870470e-01 -0.8726966457  0.034277115  0.003226954 -0.0004437402 -0.0004566049\n# PrctFFB  -8.526499e-03 -0.0291964492 -0.904388519  0.425174911 -0.0083876301  0.0103890723\n# Frame    -3.111988e-03 -0.0048861100 -0.133266834 -0.311194400 -0.3905733600  0.8552041268\n# BkFat    -6.919922e-05  0.0004925452  0.018864084  0.005278296 -0.0119061237  0.0437862261\n# SaleHt   -9.329509e-03 -0.0085770135 -0.284214793 -0.593037047  0.7485979836  0.0823314748\n# SaleWt   -8.732589e-01  0.4871927200 -0.004846824  0.005597435 -0.0026647979 -0.0003410092\n# PC7\n# YrHgt     0.0245917521\n# FtFrBody -0.0002530995\n# PrctFFB   0.0142927590\n# Frame    -0.0379840767\n# BkFat     0.9987777777\n# SaleHt    0.0138200628\n# SaleWt   -0.0002556156\n\npca_bulls_excep\n\n\nplot(pca_bulls_excep, type='l')\n\n## 4번\nbiplot(pca_bulls_excep)\n\n# pca_bulls_excep$x[,1]\n\n## 5번\n## pch : 모양을 나타냄\n## Breed를 숫자로 변환하여 모양을 다르게 함.(col값은 숫자도 가능)\nplot(pca_bulls_excep$x[,1], pca_bulls_excep$x[,2], xlab=\"PC1\", ylab=\"PC2\", \n     pch=as.numeric(bulls$Breed))\n\n## 각 점 위에 Breed 표시\n## labels 표시할 때 문자로 변환, 색깔은 숫자로 변환\ntext(pca_bulls_excep$x[,1], pca_bulls_excep$x[,2], labels=as.character(bulls$Breed), \n     cex=0.7, pos=3, col=as.numeric(bulls$Breed))\n\n\n## 3번종이면서 SaleWt가 큰 소########################################\n# bulls_Breed_3 <- bulls[as.character(bulls$Breed) =='3', ]\n# bulls_Breed_3[max(bulls_Breed_3$SaleWt),]\n# \n# bulls_Breed_3[(bulls_Breed_3$SaleWt == max(bulls_Breed_3$SaleWt)),]\n######################################################################\n\n## 6번 \nqqnorm(pca_bulls_excep$x[,1])\nqqline(pca_bulls_excep$x[,1], col=\"red\")\n\n####################################################################################\n",
    "created" : 1443846835307.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2547599480",
    "id" : "63B15124",
    "lastKnownWriteTime" : 1444537871,
    "path" : "C:/MultivariateStatis/week4/week4.R",
    "project_path" : "week4.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_source"
}