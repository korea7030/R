data = read.csv("potthoffroy.csv")
head(data)
data <- reshape(data, idvar="id", varying=list(3:6), v.names="dist")
data <- reshape(data, idvar="id", varying=list(3:6), v.names="dist", direction="long")
head(data)
library(ggplot2)
ggplot(data, aes(x=time, y=dist, group=id)) + geom_points()
ggplot(data, aes(x=time, y=dist, group=id, colours=sex))+geom_line(stat="identity")+geom_point()
ggplot(data, aes(x=time, y=dist, group=id, colors=sex))+geom_line(stat="identity")+geom_point()
ggplot(data, aes(x=time, y=dist, group=id, colour=sex))+geom_line(stat="identity")+geom_point()
model1 <- lm(dist~time, data=data)
summary(model1)
model1$fitted.values
data$fit1 <- model1$fitted
data
ggplot(data, aes(x=time, y=fit1, group=id, colour=sex))+geom_line(stat="identity")+geom_point()
model2 <- lm(dist~time+sex, data=data)
summary(model2)
data$fit2 <- model2$fitted
ggplot(data, aes(x=time, y=fit2, group=id, colour=sex))+geom_line(stat="identity")+geom_point()
model3 <- lm(dist~time+sex+sex:time, data=data)
summary(model3)
data$fit3 <- model3$fitted
ggplot(data, aes(x=time, y=fit3, group=id, colour=sex))+geom_line(stat="identity")+geom_point()
summary(model3)
timber <- read.csv("timber.csv")
head(timber)
ggplot(timber, aes(x=slippage, y=loads, group=specimen))+geom_line(stat="identity")+geom_point()
model4 <- lm(loads~slippage+I(slippage^2), data=timber) # 선형 b0+b1*slippage
summary(model4)
model4 <- lm(loads~slippage+I(slippage^2), data=timber)
timber$fit1 <- model4.fitted
timber$fit1 <- model4$fitted
ggplot(timber, aes(x=slippage, y=fit1, group=specimen))+geom_line(stat="identity")+geom_point()
model5 <- lm(loads~slippage+I(slippage^2)+specimen, data=timber)
summary(model6)
summary(model5)
timber$fit2 <- model5$fitted
ggplot(timber, aes(x=slippage, y=fit2, group=specimen))+geom_line(stat="identity")+geom_point()
ggplot(timber, aes(x=slippage, y=fit2, group=specimen))+geom_line(stat="identity")+geom_point()
library(lme4)
model6 <- lmer(loads~slippage+I(slippage^2)+(1|specimen), data=timber)
summary(model6)
library(lmerTest)
install.packages("lmerTest")
library(lmerTest)
summary(model6)
timber$fit3 <- fitted(model6)
ggplot(timber, aes(x=slippage, y=fit3, group=specimen))+geom_line(stat="identity")+geom_point()
model7 <- lmer(loads~slippage+I(slippage^2)+(1+specimen|specimen), data=timber)
model7 <- lmer(loads~slippage+I(slippage^2)+(1+specimen|specimen), data=timber)
model7 <- lmer(loads~slippage+I(slippage^2)+(1+slippage|specimen), data=timber)
timber$fit4 <- fitted(model7)
ggplot(timber, aes(x=slippage, y=fit4, group=specimen))+geom_line(stat="identity")+geom_point()
timber$fit4 <- fitted(model7)
ggplot(timber, aes(x=slippage, y=fit4, group=specimen))+geom_line(stat="identity")+geom_point()
model8 <- lmer(dist~time+sex+sex:time+(1|id), data=data)
summary(model8)
summary(model8)
data$fit8 <- fitted(model8)
ggplot(data, aes(x=time, y=fit8, group=id, colour=sex))+geom_line(stat="identity")+geom_point()
model9 <- lmer(dist~time+sex+sex:time+(1+time|id), data=data)
summary(model9)
data$fit9 <- fitted(model9)
ggplot(data, aes(x=time, y=fit9, group=id, colour=sex))+geom_line(stat="identity")+geom_point()
